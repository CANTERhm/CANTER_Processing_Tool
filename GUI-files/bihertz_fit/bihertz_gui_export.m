function varargout = bihertz_gui_export(varargin)
% BIHERTZ_GUI_EXPORT MATLAB code for bihertz_gui_export.fig
%      BIHERTZ_GUI_EXPORT, by itself, creates a new BIHERTZ_GUI_EXPORT or raises the existing
%      singleton*.
%
%      H = BIHERTZ_GUI_EXPORT returns the handle to a new BIHERTZ_GUI_EXPORT or the handle to
%      the existing singleton*.
%
%      BIHERTZ_GUI_EXPORT('CALLBACK',hObject,eventData,handles,...) calls the local
%      function named CALLBACK in BIHERTZ_GUI_EXPORT.M with the given input arguments.
%
%      BIHERTZ_GUI_EXPORT('Property','Value',...) creates a new BIHERTZ_GUI_EXPORT or raises the
%      existing singleton*.  Starting from the left, property value pairs are
%      applied to the GUI before bihertz_gui_export_OpeningFcn gets called.  An
%      unrecognized property name or invalid value makes property application
%      stop.  All inputs are passed to bihertz_gui_export_OpeningFcn via varargin.
%
%      *See GUI Options on GUIDE's Tools menu.  Choose "GUI allows only one
%      instance to run (singleton)".
%
% See also: GUIDE, GUIDATA, GUIHANDLES

% Edit the above text to modify the response to help bihertz_gui_export

% Last Modified by GUIDE v2.5 20-Dec-2018 17:23:21
    warning off
% Begin initialization code - DO NOT EDIT
gui_Singleton = 1;
gui_State = struct('gui_Name',       mfilename, ...
                   'gui_Singleton',  gui_Singleton, ...
                   'gui_OpeningFcn', @bihertz_gui_export_OpeningFcn, ...
                   'gui_OutputFcn',  @bihertz_gui_export_OutputFcn, ...
                   'gui_LayoutFcn',  @bihertz_gui_export_LayoutFcn, ...
                   'gui_Callback',   []);
if nargin && ischar(varargin{1})
    gui_State.gui_Callback = str2func(varargin{1});
end

if nargout
    [varargout{1:nargout}] = gui_mainfcn(gui_State, varargin{:});
else
    gui_mainfcn(gui_State, varargin{:});

end
% End initialization code - DO NOT EDIT


% --- Executes just before bihertz_gui_export is made visible.
function bihertz_gui_export_OpeningFcn(hObject, ~, handles, varargin)
% This function has no output args, see OutputFcn.
% hObject    handle to figure
% eventdata  reserved - to be defined in a future version of MATLAB
% handles    structure with handles and user data (see GUIDATA)
% varargin   command line arguments to bihertz_gui_export (see VARARGIN)
warning off
% Choose default command line output for bihertz_gui_export
handles.output = hObject;

% get default window size and save led width
handles.def_wind_width = handles.figure1.Position(3);
handles.def_wind_height = handles.figure1.Position(4);
handles.def_led_width = handles.save_status_led.Position(3);
handles.def_led_x = handles.save_status_led.Position(1);
handles.def_led_y = handles.save_status_led.Position(2);

% Update handles structure
handles.options = varargin{1};
handles.curves = struct([]);
handles.figures = struct('main_fig',[]);
handles.load_status = 0;
handles.save_status = 1;
handles.interpolation_type = 'bicubic';

guidata(hObject, handles);


% set gui appearance depending on chosen model
handles.fit_model_popup.Enable = 'on';
switch handles.options.model
    case 'bihertz'
        % in this case it is good as it is ;)
    case 'hertz'
        handles.fit_model_popup.Value = 2;
        handles.uipanel5.Visible = 'off';
        handles.uipanel10.Visible = 'off';
        handles.hertz_fit_panel.Visible = 'on';
        axes(handles.map_axes);
        axis off
end



% UIWAIT makes bihertz_gui_export wait for user response (see UIRESUME)
% uiwait(handles.figure1);


% --- Outputs from this function are returned to the command line.
function varargout = bihertz_gui_export_OutputFcn(~, ~, handles) 
% varargout  cell array for returning output args (see VARARGOUT);
% hObject    handle to figure
% eventdata  reserved - to be defined in a future version of MATLAB
% handles    structure with handles and user data (see GUIDATA)

% Get default command line output from handles structure
varargout{1} = handles.options;
varargout{2} = handles;

% maximise window
handles.figure1.WindowState = 'maximized';


% --- Executes on selection change in listbox1.
function listbox1_Callback(hObject, ~, ~)
% hObject    handle to listbox1 (see GCBO)
% eventdata  reserved - to be defined in a future version of MATLAB
% handles    structure with handles and user data (see GUIDATA)

% Hints: contents = cellstr(get(hObject,'String')) returns listbox1 contents as cell array
%        contents{get(hObject,'Value')} returns selected item from listbox1
text = get(hObject,'Value');
fprintf('Left click on list-value %g\n',text);



% --- Executes during object creation, after setting all properties.
function listbox1_CreateFcn(hObject, ~, ~)
% hObject    handle to listbox1 (see GCBO)
% eventdata  reserved - to be defined in a future version of MATLAB
% handles    empty - handles not created until after all CreateFcns called

% Hint: listbox controls usually have a white background on Windows.
%       See ISPC and COMPUTER.
if ispc && isequal(get(hObject,'BackgroundColor'), get(0,'defaultUicontrolBackgroundColor'))
    set(hObject,'BackgroundColor','white');
end


% --- If Enable == 'on', executes on mouse press in 5 pixel border.
% --- Otherwise, executes on mouse press in 5 pixel border or over listbox1.
function listbox1_ButtonDownFcn(hObject, ~, ~)
% hObject    handle to listbox1 (see GCBO)
% eventdata  reserved - to be defined in a future version of MATLAB
% handles    structure with handles and user data (see GUIDATA)
test = get(hObject,'Value');
fprintf('Right click on list-value %g\n',test)



function edit_filepath_Callback(~, ~, ~)
% hObject    handle to edit_filepath (see GCBO)
% eventdata  reserved - to be defined in a future version of MATLAB
% handles    structure with handles and user data (see GUIDATA)

% Hints: get(hObject,'String') returns contents of edit_filepath as text
%        str2double(get(hObject,'String')) returns contents of edit_filepath as a double


% --- Executes during object creation, after setting all properties.
function edit_filepath_CreateFcn(hObject, ~, ~)
% hObject    handle to edit_filepath (see GCBO)
% eventdata  reserved - to be defined in a future version of MATLAB
% handles    empty - handles not created until after all CreateFcns called

% Hint: edit controls usually have a white background on Windows.
%       See ISPC and COMPUTER.
if ispc && isequal(get(hObject,'BackgroundColor'), get(0,'defaultUicontrolBackgroundColor'))
    set(hObject,'BackgroundColor','white');
end


% --- Executes on button press in button_file.
function button_file_Callback(hObject, ~, handles)
% hObject    handle to button_file (see GCBO)
% eventdata  reserved - to be defined in a future version of MATLAB
% handles    structure with handles and user data (see GUIDATA)
[file,path,indx] = uigetfile({'*.jpk-force-map','JPK-Force-map (*.jpk-force-map)';...
    '*.tsv','Single tsv-file (*.tsv)'},'Select a File');

if ~isequal(file,0)
    set(handles.edit_filepath,'String',fullfile(path,file))
    handles.filefilter = indx;
    handles.loadtype = 'file';
    guidata(hObject,handles)
end

% --- Executes on button press in button_load_data.
function button_load_data_Callback(hObject, ~, handles)
% hObject    handle to button_load_data (see GCBO)
% eventdata  reserved - to be defined in a future version of MATLAB
% handles    structure with handles and user data (see GUIDATA)
answer = 0;
if handles.load_status == 1
    answer = questdlg({'There is loaded data!',...
        'If you load new data all unsaved results will be lost!',...
        'Do you really want to load new data?'},...
        'Loaded data warning','Yes','No','No');
end

if strcmp(answer,'No')
    return;
elseif strcmp(answer,'Yes')  || answer == 0
    path = get(handles.edit_filepath,'String');
    if strcmp(path,'    filepath')
        errordlg('No file or folder selected','No selection found');
    else
        handles.options = Calibration(handles.options);
        guidata(hObject,handles);
        handles.options = canti_sample_gui(handles.options);
        guidata(hObject,handles);
        
        handles.tip_angle = handles.options.tip_angle;
        handles.poisson = handles.options.poisson;
        handles.tip_shape = handles.options.tip_shape;



        % provide processing infos
        str = sprintf('Sensitivity: %.2f nm/V',handles.options.sensitivity);
        set(handles.text_sensitivity,'String',str);
        str = sprintf('Spring constant: %.4f N/m',handles.options.spring_const);
        set(handles.text_spring_const,'String',str);

        switch handles.loadtype
            case 'file'
                if handles.filefilter == 1
                   [x_data,y_data, ~, ~, Forcecurve_label,~,~,name_of_file,~,map_images] = ReadJPKMaps(handles.edit_filepath.String);
                   % create filename array
                   Forcecurve_label = Forcecurve_label';
                   curves_in_map = strcat(name_of_file,'.',Forcecurve_label);
                   handles.file_names = curves_in_map;
                   Forcecurve_label = Forcecurve_label';
                   % save map image in handles and display in axes
                   handles.map_images = map_images;
                   guidata(hObject,handles);
                   axes(handles.map_axes);
                   % get image channels
                   handles.channel_names = fieldnames(handles.map_images);
                   if strcmp(handles.channel_names{1},'thumbnail')
                       handles.channel_names(1) = [];
                   end
                   handles.image_channels_popup.String = handles.channel_names;
                   
                   % create processing grid for visual curve feedback
                   map_tags = fieldnames(handles.map_images);
                   if strcmp(map_tags{1},'thumbnail')
                       map_tags(1) = [];
                   end
                   handles.map_info = struct('x_pixel',0,'y_pixel',0,'processing_grid',[0,0]);
                   handles.map_info.x_pixel = handles.map_images.(map_tags{1}).XPixel;
                   handles.map_info.y_pixel = handles.map_images.(map_tags{1}).YPixel;
                   handles.map_info.processing_grid = zeros(handles.map_info.x_pixel*handles.map_info.y_pixel,2);
                   grid_index = 0;
                   for i=1:(handles.map_info.y_pixel)
                       for j = 1:(handles.map_info.x_pixel)
                           grid_index = grid_index + 1;
                           handles.map_info.processing_grid(grid_index,1) = j;
                           handles.map_info.processing_grid(grid_index,2) = i;
                       end
                   end                           
                       
                   % write image channels in popup
                   handles.image_channels_popup.Enable = 'on';
                   for i=1:length(handles.channel_names)
                       if strcmp(handles.channel_names{i},'height')
                           handles.image_channels_popup.Value = i;
                           channel_image = handles.map_images.height.absolute_height_data_bicubic_interpolation;
                           imshow(flip(channel_image,1),[],'InitialMagnification','fit','XData',[1 handles.map_info.x_pixel],'YData',[1 handles.map_info.y_pixel]);
                           handles.map_axes.YDir = 'normal';
                           hline = findall(gca,'Type','image');
                           set(hline(1),'uicontextmenu',handles.map_axes_context);
                           set_afm_gold;
                           break
                       elseif i==length(handles.channel_names) && ~strcmp(handles.channel_names{i},'height')
                           handles.image_channels_popup.Value = 1;
                           channel_image = handles.map_images.(handles.channel_names{i}).(sprintf('%s_data_bicubic_interpolation',...
                                handles.channel_names{i}));
                           imshow(flip(channel_image,1),[],'InitialMagnification','fit','XData',[1 handles.map_info.x_pixel],'YData',[1 handles.map_info.y_pixel]);
                           handles.map_axes.YDir = 'normal';
                           hline = findall(gca,'Type','image');
                           set(hline(1),'uicontextmenu',handles.map_axes_context);
                           set_afm_gold;
                       end
                   end
                   
                   % display first processing grid point and text
                   axes(handles.map_axes);
                   hold(handles.map_axes,'on');
                   handles.figures.proc_point = plot(1,1,'.w','MarkerSize',15);
                   handles.figures.proc_text = text(1.5,1.5,'1','Color','w','FontWeight','bold');
                   hold(handles.map_axes,'off');
                   guidata(hObject,handles);
                   
                elseif handles.filefilter == 2
                    % look for filefilter in handles and choose right load function
                    % UNDER CONSTRUCTION
                    warndlg('The option to load a single txt or tsv file is not yet implemented!',...
                        'UNDER CONSTRUCTION!');
                end
                num_files = length(Forcecurve_label);
                % preinitialise curve struct
                for i=1:num_files
                    c_string = sprintf('curve%u',i);
                    curves.(c_string) = struct('x_values',[],'y_values',[]);                    
                end
                
                % create waitbar for load process with cancel button
                wb_num = 0;
                wb = waitbar(0,sprintf('Loading progress: %.g%%',wb_num*100),'Name',...
                    'Loading ...','CreateCancelBtn','setappdata(gcbf,''canceling'',1)');
                setappdata(wb,'canceling',0);
                % prelocate listbox cell
                it(1:num_files,1) = {''};
                handles.listbox1.String = it;
                guidata(hObject,handles);
                
                % load x and y values from file in struct elements
                for i=1:num_files
                    % Check for clicked cancel button
                    if getappdata(wb,'canceling')
                        break
                    end
                    % load x and y values of each force curve
                    c_string = sprintf('curve%u',i);
                    curves.(c_string).x_values = x_data.(Forcecurve_label{i}).*1e-6;
                    curves.(c_string).y_values = y_data.(Forcecurve_label{i}).*1e-9;
                    % add listbox element                  
                    it = handles.listbox1.String;
                    it{i,1} = sprintf('curve %3u  ->  unprocessed',i);
                    handles.listbox1.String = it;
                    % update waitbar
                    wb_num = i/num_files;
                    waitbar(wb_num,wb,sprintf('Loading progress: %.f%%',wb_num*100))
                end
                
            case 'folder'
                folderpath = get(handles.edit_filepath,'String');       % get folder location
                listing = dir(folderpath);                              % information of files in folder
                filetype = strsplit(listing(3).name, '.');
                % Check if the folder contains .ibw files from the MFP-3D
                if strcmp(filetype(1,2), 'ibw') == 1                   
                    [x_data,y_data,~,~, Forcecurve_count] = ReadMFPMaps(folderpath);
                    
                    
                else
                    T_files_in_folder = struct2table(listing);
                    files_in_folder = table2array(T_files_in_folder(:,1));
                    files_in_folder(1:2) = [];                              % cell array with all file names
                    handles.file_names = files_in_folder;                   % save the filenames
                    num_files = length(files_in_folder);                    % number of files in folder

                    % preinitialise curve struct
                    for i=1:num_files
                        c_string = sprintf('curve%u',i);
                        curves.(c_string) = struct('x_values',[],'y_values',[]);                    
                    end

                    % create waitbar for load process with cancel button
                    wb_num = 0;
                    wb = waitbar(0,sprintf('Loading progress: %.g%%',wb_num*100),'Name',...
                        'Loading ...','CreateCancelBtn','setappdata(gcbf,''canceling'',1)');
                    setappdata(wb,'canceling',0);
                    % prelocate listbox cell
                    it(1:num_files,1) = {''};
                    handles.listbox1.String = it;
                    guidata(hObject,handles);

                    % load x and y values from file in struct elements
                    for i=1:num_files
                        % Check for clicked cancel button
                        if getappdata(wb,'canceling')
                            break
                        end
                        % load x and y values of next file in folder
                        filepath = fullfile(path,files_in_folder{i});
                        % get first line with number
                        testid = fopen(filepath);
                        line = fgetl(testid);
                        count = 1;
                        while ischar(line)
                            line = fgetl(testid);
                            line_sep = split(line,' ');
                            if ~strcmp(line_sep{1},'#') && ~isempty(line_sep{1})
                                break
                            end
                            count = count + 1;
                        end       
                        count = count + 1;
                        fclose(testid);         
                        coordinates = import_force_curve_txt_file_fast(filepath,count);
                        c_string = sprintf('curve%u',i);
                        curves.(c_string).x_values = coordinates.x_values;
                        curves.(c_string).y_values = coordinates.y_values;
                        % add listbox element                  
                        it = handles.listbox1.String;
                        it{i,1} = sprintf('curve %3u  ->  unprocessed',i);
                        handles.listbox1.String = it;
                        % update waitbar
                        wb_num = i/num_files;
                        waitbar(wb_num,wb,sprintf('Loading progress: %.f%%',wb_num*100))
                    end
                end

        end
        
        handles.listbox1.Value = 1;         % highlight listbox item number one
        handles.curves = curves;            % write curves struct to handles
        handles.current_curve = 1;          % set the current curve to first
        handles.load_status = 1;            % set load status tag to 1
        handles.save_status = 0;            % set save status tag to 0
        handles.save_status_led.BackgroundColor = [1 0 0];
        delete(wb)                          % delete loading waitbar
        if i == num_files
            handles.num_files = num_files;  % provide max curve number in handles
        else
            num_files = i-1;                % number of fully loaded curves
            handles.num_files = i-1;        % provide max curve number in handles                    
        end

        % write progress values
        % needed variables
        handles.progress = struct('num_unprocessed',num_files,...
                                  'num_processed',0,...
                                  'num_discarded',0);
        % write process
        [hObject,handles] = update_progress_info(hObject,handles);
        
        % create struct for processed data
        handles.proc_curves = curves;
        
        %% Curve processing function V
        % function for the processing of current curve depending on user
        % options.
        try
        [hObject,handles] = process_options(hObject,handles);
        catch
        end
        %%
        
        % create main plot window for displaying processed curves
        if ~isempty(handles.figures.main_fig)
            delete(handles.figures.main_fig);
            handles.figures.main_fig = [];
        end

        handles.figures.main_fig = figure('NumberTitle','off','Name','Main plot window');
        figure(handles.figures.main_fig);
        handles.figures.main_fig.CloseRequestFcn = {@main_plot_CloseRequest,handles};
        handles.figures.main_ax = axes;
        handles.figures.main_ax.FontSize = 16;
        hold(handles.figures.main_ax,'on');
        handles.figures.main_plot = plot(nan,nan);
        handles.figures.patch_handle = patch(nan,nan,nan);
        hold(handles.figures.main_ax,'off');
        xlabel('Vertical tip position [µm]');
        ylabel({'Force [nN]';''});
        guidata(hObject,handles);
        %Plot the data as Bihertz or as Hertz
        switch handles.options.model
            case 'bihertz'
                [handles] = plot_bihertz(handles);
                guidata(hObject,handles);
            case 'hertz'
                [hObject,handles] = plot_hertz(hObject,handles);
                guidata(hObject,handles);
        end

        % fit data to processed curve and display fitresult
        [hObject,handles] = curve_fit_functions(hObject,handles);
        guidata(hObject,handles);

        % prelocate result table
        switch handles.options.model
            case 'bihertz'
                varTypes =  {'string','uint64','double','double','double',...
                             'double','double','double','double'};
                varNames = {'File_name','Index','initial_E_s_Pa','initial_E_h_Pa',...
                            'initial_d_h_m','fit_E_s_Pa','fit_E_h_Pa','fit_d_h_m','rsquare_fit'};
                handles.T_result = table('size',[handles.num_files 9],'VariableTypes',varTypes,'VariableNames',varNames);
            case 'hertz'
                varTypes =  {'string','uint64','double','double'};
                varNames = {'File_name','Index','EModul','rsquare_fit'};
                handles.T_result = table('size',[num_files 4],'VariableTypes',varTypes,'VariableNames',varNames);
        end


        % update gui fit results
        [hObject,handles] = update_fit_results(hObject,handles);

        % activate the gui buttons
        handles.button_keep.Enable = 'on';
        handles.button_discard.Enable = 'on';
        handles.button_keep_all.Enable = 'on';
        handles.fit_model_popup.Enable = 'on';
        
    end
end
guidata(hObject,handles);





function edit_savepath_Callback(~, ~, ~) %#ok<*DEFNU>
% hObject    handle to edit_savepath (see GCBO)
% eventdata  reserved - to be defined in a future version of MATLAB
% handles    structure with handles and user data (see GUIDATA)

% Hints: get(hObject,'String') returns contents of edit_savepath as text
%        str2double(get(hObject,'String')) returns contents of edit_savepath as a double


% --- Executes during object creation, after setting all properties.
function edit_savepath_CreateFcn(hObject, ~, ~)
% hObject    handle to edit_savepath (see GCBO)
% eventdata  reserved - to be defined in a future version of MATLAB
% handles    empty - handles not created until after all CreateFcns called

% Hint: edit controls usually have a white background on Windows.
%       See ISPC and COMPUTER.
if ispc && isequal(get(hObject,'BackgroundColor'), get(0,'defaultUicontrolBackgroundColor'))
    set(hObject,'BackgroundColor','white');
end


% --- Executes on button press in button_save_path.
function button_save_path_Callback(hObject, ~, ~)
% hObject    handle to button_save_path (see GCBO)
% eventdata  reserved - to be defined in a future version of MATLAB
% handles    structure with handles and user data (see GUIDATA)

[file,path] = uiputfile({'*.tsv;*.xlsx','Save files (*.tsv,*.xlsx)';...
                '*.*','All Files (*.*)'});
savepath = fullfile(path,file);
hObject.String = savepath;

% --- Executes on button press in pushbutton7.
function pushbutton7_Callback(~, ~, ~)
% hObject    handle to pushbutton7 (see GCBO)
% eventdata  reserved - to be defined in a future version of MATLAB
% handles    structure with handles and user data (see GUIDATA)



function edit2_Callback(~, ~, ~)
% hObject    handle to edit2 (see GCBO)
% eventdata  reserved - to be defined in a future version of MATLAB
% handles    structure with handles and user data (see GUIDATA)

% Hints: get(hObject,'String') returns contents of edit2 as text
%        str2double(get(hObject,'String')) returns contents of edit2 as a double


% --- Executes during object creation, after setting all properties.
function edit2_CreateFcn(hObject, ~, ~)
% hObject    handle to edit2 (see GCBO)
% eventdata  reserved - to be defined in a future version of MATLAB
% handles    empty - handles not created until after all CreateFcns called

% Hint: edit controls usually have a white background on Windows.
%       See ISPC and COMPUTER.
if ispc && isequal(get(hObject,'BackgroundColor'), get(0,'defaultUicontrolBackgroundColor'))
    set(hObject,'BackgroundColor','white');
end


% --- Executes on button press in pushbutton4.
function pushbutton4_Callback(~, ~, ~)
% hObject    handle to pushbutton4 (see GCBO)
% eventdata  reserved - to be defined in a future version of MATLAB
% handles    structure with handles and user data (see GUIDATA)


% --- Executes on button press in pushbutton5.
function pushbutton5_Callback(~, ~, ~)
% hObject    handle to pushbutton5 (see GCBO)
% eventdata  reserved - to be defined in a future version of MATLAB
% handles    structure with handles and user data (see GUIDATA)



function fit_depth_Callback(hObject, ~, handles)
% hObject    handle to fit_depth (see GCBO)
% eventdata  reserved - to be defined in a future version of MATLAB
% handles    structure with handles and user data (see GUIDATA)

% Hints: get(hObject,'String') returns contents of fit_depth as text
%        str2double(get(hObject,'String')) returns contents of fit_depth as a double
[hObject,handles] = update_patches(hObject,handles);
guidata(hObject,handles)


% --- Executes during object creation, after setting all properties.
function fit_depth_CreateFcn(hObject, ~, ~)
% hObject    handle to fit_depth (see GCBO)
% eventdata  reserved - to be defined in a future version of MATLAB
% handles    empty - handles not created until after all CreateFcns called

% Hint: edit controls usually have a white background on Windows.
%       See ISPC and COMPUTER.
if ispc && isequal(get(hObject,'BackgroundColor'), get(0,'defaultUicontrolBackgroundColor'))
    set(hObject,'BackgroundColor','white');
end



function fit_perc_Callback(hObject, ~, handles)
% hObject    handle to fit_perc (see GCBO)
% eventdata  reserved - to be defined in a future version of MATLAB
% handles    structure with handles and user data (see GUIDATA)

% Hints: get(hObject,'String') returns contents of fit_perc as text
%        str2double(get(hObject,'String')) returns contents of fit_perc as a double
[hObject,handles] = update_patches(hObject,handles);
guidata(hObject,handles);

% --- Executes during object creation, after setting all properties.
function fit_perc_CreateFcn(hObject, ~, ~)
% hObject    handle to fit_perc (see GCBO)
% eventdata  reserved - to be defined in a future version of MATLAB
% handles    empty - handles not created until after all CreateFcns called

% Hint: edit controls usually have a white background on Windows.
%       See ISPC and COMPUTER.
if ispc && isequal(get(hObject,'BackgroundColor'), get(0,'defaultUicontrolBackgroundColor'))
    set(hObject,'BackgroundColor','white');
end


% --- Executes on button press in button_keep_highlighted.
function button_keep_highlighted_Callback(~, ~, handles)
% hObject    handle to button_keep_highlighted (see GCBO)
% eventdata  reserved - to be defined in a future version of MATLAB
% handles    structure with handles and user data (see GUIDATA)


% --- Executes on button press in button_undo_highlighted.
function button_undo_highlighted_Callback(hObject, eventdata, handles)
% hObject    handle to button_undo_highlighted (see GCBO)
% eventdata  reserved - to be defined in a future version of MATLAB
% handles    structure with handles and user data (see GUIDATA)


% --- Executes on button press in button_discard_highlighted.
function button_discard_highlighted_Callback(hObject, eventdata, handles)
% hObject    handle to button_discard_highlighted (see GCBO)
% eventdata  reserved - to be defined in a future version of MATLAB
% handles    structure with handles and user data (see GUIDATA)


% --- Executes on button press in button_keep.
function button_keep_Callback(hObject, ~, handles)
% hObject    handle to button_keep (see GCBO)
% eventdata  reserved - to be defined in a future version of MATLAB
% handles    structure with handles and user data (see GUIDATA)

handles.fit_model_popup.Enable = 'off';

% save fit results
curve_index = handles.current_curve;
discarded = handles.progress.num_discarded;

switch handles.options.model
    case 'bihertz'
        handles.T_result(curve_index-discarded,:) = {handles.file_names(curve_index),...
                           uint64(curve_index),...
                           handles.fit_results.initial_E_s,...
                           handles.fit_results.initial_E_h,...
                           handles.fit_results.initial_d_h,...
                           handles.fit_results.fit_E_s,...
                           handles.fit_results.fit_E_h,...
                           handles.fit_results.fit_d_h,...
                           handles.fit_results.rsquare_fit};

    case 'hertz'
        handles.T_result(curve_index-discarded,:) = {handles.file_names(curve_index),...
                           uint64(curve_index),...
                           handles.fit_results.EModul,...
                           handles.fit_results.gof_rsquare};
end


% change listbox element                  
it = handles.listbox1.String;
it{curve_index,1} = sprintf('curve %3u  ->  processed',curve_index);
handles.listbox1.String = it;


% add 1 to the current_curve value
handles.current_curve = curve_index +1;
new_curve_index = curve_index + 1;
guidata(hObject,handles);

% update current curve marker on map axes
handles = update_curve_marker(handles);

%Check if the last force curve is reached
if new_curve_index == handles.num_files+1

        
    % disable buttons during processing
    handles.button_keep.Enable = 'off';
    handles.button_discard.Enable = 'off';
    handles.button_keep_all.Enable = 'off';
    
    % update progress values
    handles.progress.num_unprocessed = handles.progress.num_unprocessed -1;
    handles.progress.num_processed = handles.progress.num_processed +1; 
    
    % write progess info
    [hObject,handles] = update_progress_info(hObject,handles);
    guidata(hObject,handles);
    
    % save dialog
    answer = questdlg({'Curve processing completed!',...
        'Do you want to save the results?'},...
        'Processing completed!','Yes','No','Yes');

    if strcmp(answer,'Yes')
        if strcmp(handles.edit_savepath.String,'     savepath')
            [file,path] = uiputfile({'*.tsv;*.xlsx','Save files (*.tsv,*.xlsx)';...
                '*.*','All Files (*.*)'});
            if path ~= 0
                savepath = fullfile(path,file);
                save_table(handles.T_result,'fileFormat','tsv','savepath',savepath);
                save_diffract = split(savepath,'.tsv');
                savepath_cell = strcat(save_diffract(1),'.xlsx');
                savepath = savepath_cell{1};
                if exist(savepath,'file') == 2
                    delete(savepath)
                end
                save_table(handles.T_result,'fileFormat','excel','savepath',savepath);
                handles.save_status = 1;
                handles.save_status_led.BackgroundColor = [0 1 0];
            end
        else 
            savepath = handles.edit_savepath.String;
            save_table(handles.T_result,'fileFormat','tsv','savepath',savepath);
            save_diffract = split(savepath,'.tsv');
            savepath = strcat(save_diffract,'.xlsx');
            save_table(handles.T_result,'fileFormat','excel','savepath',savepath);
            handles.save_status = 1;
            handles.save_status_led.BackgroundColor = [0 1 0];
        end
    end
    
else

    % highlight next list item
    handles.listbox1.Value = new_curve_index;
    guidata(hObject,handles);
    
    %Process new curve
    [hObject,handles] = process_options(hObject,handles);
    
    % draw new curve
    switch handles.options.model
        case 'bihertz'
            [handles] = plot_bihertz(handles);
            guidata(hObject,handles);
        case 'hertz'
            [hObject,handles] = plot_hertz(hObject,handles);
            guidata(hObject,handles);
    end
    
        % fit data to processed curve and display fitresult
        [hObject,handles] = curve_fit_functions(hObject,handles);
        guidata(hObject,handles);

        % update gui fit results
        [hObject,handles] = update_fit_results(hObject,handles);
        guidata(hObject,handles);
    
    % update progress values
    handles.progress.num_unprocessed = handles.progress.num_unprocessed -1;
    handles.progress.num_processed = handles.progress.num_processed +1; 
    
    % write process info
    [hObject,handles] = update_progress_info(hObject,handles);
    guidata(hObject,handles);
    
    % activate undo button when first time pushed
    if curve_index == 1
        handles.button_undo.Enable = 'on';
    end
    

end
guidata(hObject,handles);





% --- Executes on button press in button_discard.
function button_discard_Callback(hObject, ~, handles)
% hObject    handle to button_discard (see GCBO)
% eventdata  reserved - to be defined in a future version of MATLAB
% handles    structure with handles and user data (see GUIDATA)

handles.fit_model_popup.Enable = 'off';

% Don't write fit results
curve_index = handles.current_curve;
discarded = handles.progress.num_discarded;
handles.T_result(curve_index-discarded,:) = [];

                
% change listbox element                  
it = handles.listbox1.String;
it{curve_index,1} = sprintf('curve %3u  ->  discarded',curve_index);
handles.listbox1.String = it;


% add 1 to the current_curve value
handles.current_curve = curve_index +1;
new_curve_index = curve_index + 1;
guidata(hObject,handles);

% update current curve marker on map axes
handles = update_curve_marker(handles);

if new_curve_index == handles.num_files+1
    
    % disable buttons during processing
    handles.button_keep.Enable = 'off';
    handles.button_discard.Enable = 'off';
    handles.button_keep_all.Enable = 'off';
    
    % update progress values
    handles.progress.num_unprocessed = handles.progress.num_unprocessed -1;
    handles.progress.num_discarded = handles.progress.num_discarded +1; 
    
    % write process info
    [hObject,handles] = update_progress_info(hObject,handles);
    guidata(hObject,handles);
    
    % save dialog
    answer = questdlg({'Curve processing completed!',...
        'Do you want to save the results?'},...
        'Processing completed!','Yes','No','Yes');
    
    if strcmp(answer,'Yes')
        if strcmp(handles.edit_savepath.String,'     savepath')
            [file,path] = uiputfile({'*.tsv;*.xlsx','Save files (*.tsv,*.xlsx)';...
                '*.*','All Files (*.*)'});
            if path ~= 0
                savepath = fullfile(path,file);
                save_table(handles.T_result,'fileFormat','tsv','savepath',savepath);
                save_diffract = split(savepath,'.tsv');
                savepath_cell = strcat(save_diffract(1),'.xlsx');
                savepath = savepath_cell{1};
                if exist(savepath,'file') == 2
                    delete(savepath)
                end
                save_table(handles.T_result,'fileFormat','excel','savepath',savepath);
                handles.save_status = 1;
                handles.save_status_led.BackgroundColor = [0 1 0];
            end
        else 
            savepath = handles.edit_savepath.String;
            save_table(handles.T_result,'fileFormat','tsv','savepath',savepath);
            save_diffract = split(savepath,'.tsv');
            savepath = strcat(save_diffract,'.xlsx');
            if exist(savepath,'file') == 2
                    delete(savepath)
            end
            save_table(handles.T_result,'fileFormat','excel','savepath',savepath);
            handles.save_status = 1;
            handles.save_status_led.BackgroundColor = [0 1 0];
        end
    end
    
else

    % highlight next list item
    handles.listbox1.Value = new_curve_index;
    guidata(hObject,handles);
    
    %Process new curve
    [hObject,handles] = process_options(hObject,handles);
    
    % draw new curve
    switch handles.options.model
        case 'bihertz'
            [handles] = plot_bihertz(handles);
            guidata(hObject,handles);
        case 'hertz'
            [hObject,handles] = plot_hertz(hObject,handles);
            guidata(hObject,handles);
    end

    % fit data to processed curve and display fitresult
    [hObject,handles] = curve_fit_functions(hObject,handles);
    guidata(hObject,handles);

    % update gui fit results
    [hObject,handles] = update_fit_results(hObject,handles);
    guidata(hObject,handles);
    
    % update progress values
    handles.progress.num_unprocessed = handles.progress.num_unprocessed -1;
    handles.progress.num_discarded = handles.progress.num_discarded +1;
    guidata(hObject,handles);
    
    % write process info
    [hObject,handles] = update_progress_info(hObject,handles);
    guidata(hObject,handles);
    
    % activate undo button when first time pushed
    if curve_index == 1
        handles.button_undo.Enable = 'on';
    end
    
end
guidata(hObject,handles);


% --- Executes on button press in button_undo.
function button_undo_Callback(hObject, ~, handles)
% hObject    handle to button_undo (see GCBO)
% eventdata  reserved - to be defined in a future version of MATLAB
% handles    structure with handles and user data (see GUIDATA)

% set save status to 0
handles.save_status = 0;
handles.save_status_led.BackgroundColor = [0 1 0];


% Subtract 1 from the current curve value
curve_index = handles.current_curve-1;

% undo previous fit results
if curve_index == 1
    switch handles.options.model
        case 'bihertz'
            varTypes = {'string','uint64','double','double','double',...
                        'double','double','double','double'};
            varNames = {'File_name','Index','initial_E_s_Pa','initial_E_h_Pa',...
                        'initial_d_h_m','fit_E_s_Pa','fit_E_h_Pa','fit_d_h_m','rsquare_fit'};
            handles.T_result = table('Size',[handles.num_files 9],'VariableTypes',varTypes,'VariableNames',varNames);
        case 'hertz'
            varTypes =  {'string','uint64','double','double'};
            varNames = {'File_name','Index','EModul','rsquare_fit'};
            handles.T_result = table('size',[handles.num_files 4],'VariableTypes',varTypes,'VariableNames',varNames);
    end
else
    if curve_index ~= handles.num_files
        switch handles.options.model
            case 'bihertz'
                handles.T_result(end+1,:) = {missing,...
                                           uint64(0),...
                                           0,...
                                           0,...
                                           0,...
                                           0,...
                                           0,...
                                           0,...
                                           0};
            case 'hertz'
                handles.T_result(end+1,:) = {missing,uint64(0), 0, 0};
        end
    end
end
                
% change listbox element and save previous string                  
it = handles.listbox1.String;
prev_string = it{curve_index,1};
it{curve_index,1} = sprintf('curve %3u  ->  unprocessed',curve_index);
handles.listbox1.String = it;


% Save the new current_curve value
handles.current_curve = curve_index;
new_curve_index = curve_index;
guidata(hObject,handles);

% update current curve marker on map axes
handles = update_curve_marker(handles);


% highlight next list item
handles.listbox1.Value = new_curve_index;
guidata(hObject,handles);

% Process new curve
[hObject,handles] = process_options(hObject,handles);
    
% Draw new curve
switch handles.options.model
    case 'bihertz'
        [handles] = plot_bihertz(handles);
        guidata(hObject,handles);
    case 'hertz'
        [hObject,handles] = plot_hertz(hObject,handles);
        guidata(hObject,handles);
end
% fit data to processed curve and display fitresult
[hObject,handles] = curve_fit_functions(hObject,handles);
guidata(hObject,handles);

% update gui fit results
[hObject,handles] = update_fit_results(hObject,handles);
guidata(hObject,handles);

% update progress values
prev_string = split(prev_string,'  ->  ');
prev_string = prev_string{2};
switch prev_string
    case 'processed'
        handles.progress.num_unprocessed = handles.progress.num_unprocessed +1;
        handles.progress.num_processed = handles.progress.num_processed -1; 
    case 'discarded'
        handles.progress.num_unprocessed = handles.progress.num_unprocessed +1;
        handles.progress.num_discarded = handles.progress.num_discarded -1;
end
guidata(hObject,handles);

% write process info
[hObject,handles] = update_progress_info(hObject,handles);
guidata(hObject,handles);

% when first curve reached disable undo button
if new_curve_index == 1
    handles.button_undo.Enable = 'off';
    handles.fit_model_popup.Enable = 'on';
end

% if pushed after reaching the last curve keep and discard buttons are
% enabled again
if new_curve_index == handles.num_files-1
    handles.button_keep.Enable = 'on';
    handles.button_discard.Enable = 'on';
    handles.button_keep_all.Enable = 'on';
    handles.fit_model_popup.Enable = 'off';
end
guidata(hObject,handles);
    




% --- Executes on button press in button_keep_all.
function button_keep_all_Callback(hObject, ~, handles)
% hObject    handle to button_keep_all (see GCBO)
% eventdata  reserved - to be defined in a future version of MATLAB
% handles    structure with handles and user data (see GUIDATA)

    % disable buttons during processing
    handles.button_keep.Enable = 'off';
    handles.button_discard.Enable = 'off';
    handles.button_keep_all.Enable = 'off';
    handles.button_undo.Enable = 'off';

curve_index = handles.current_curve;

% loop iterations
loop_it = (handles.num_files - curve_index);

% initialise waitbar with cancel button
wb = waitbar(0,sprintf('curve %3u of %3u',curve_index,handles.num_files),...
    'CreateCancelBtn','setappdata(gcbf,''canceling'',1)');
setappdata(wb,'canceling',0);

for a = 1:loop_it
    
    % check for clicked cancel button
    if getappdata(wb,'canceling')
        break
    end
    
    
    % save fit results
    curve_index = handles.current_curve;
    discarded = handles.progress.num_discarded;
    switch handles.options.model
    case 'bihertz'
        handles.T_result(curve_index-discarded,:) = {handles.file_names(curve_index),...
                           uint64(curve_index),...
                           handles.fit_results.initial_E_s,...
                           handles.fit_results.initial_E_h,...
                           handles.fit_results.initial_d_h,...
                           handles.fit_results.fit_E_s,...
                           handles.fit_results.fit_E_h,...
                           handles.fit_results.fit_d_h,...
                           handles.fit_results.rsquare_fit};

    case 'hertz'
        handles.T_result(curve_index-discarded,:) = {handles.file_names(curve_index),...
                           uint64(curve_index),...
                           handles.fit_results.EModul,...
                           handles.fit_results.gof_rsquare};
    end

    % change listbox element                  
    it = handles.listbox1.String;
    it{curve_index,1} = sprintf('curve %3u  ->  processed',curve_index);
    handles.listbox1.String = it;


    % add 1 to the current_curve value
    handles.current_curve = curve_index +1;
    new_curve_index = curve_index + 1;
    guidata(hObject,handles);
    
    % update current curve marker on map axes
    handles = update_curve_marker(handles);


    % highlight next list item
    handles.listbox1.Value = new_curve_index;
    guidata(hObject,handles);
    
    % update waitbar and message
    waitbar(a/loop_it,wb,sprintf('curve %3u of %3u',new_curve_index,handles.num_files));

    %Process new curve
    [hObject,handles] = process_options(hObject,handles);
    
    % draw new curve
    switch handles.options.model
        case 'bihertz'
            [handles] = plot_bihertz(handles);
            guidata(hObject,handles);
        case 'hertz'
            [hObject,handles] = plot_hertz(hObject,handles);
            guidata(hObject,handles);
    end

    % fit data to processed curve and display fitresult
    [hObject,handles] = curve_fit_functions(hObject,handles);
    guidata(hObject,handles);

    % update gui fit results
    [hObject,handles] = update_fit_results(hObject,handles);
    guidata(hObject,handles);

    % update progress values
    handles.progress.num_unprocessed = handles.progress.num_unprocessed -1;
    handles.progress.num_processed = handles.progress.num_processed +1; 

    % write process info
    [hObject,handles] = update_progress_info(hObject,handles);
    guidata(hObject,handles);

end

% reable buttons after processing
handles.button_keep.Enable = 'on';
handles.button_discard.Enable = 'on';
handles.button_keep_all.Enable = 'on';
handles.button_undo.Enable = 'on';

if ~getappdata(wb,'canceling')
    
    % reable buttons after processing
    handles.button_keep.Enable = 'off';
    handles.button_discard.Enable = 'off';
    handles.button_keep_all.Enable = 'off';

    % save results of last curve
    curve_index = handles.current_curve;
    discarded = handles.progress.num_discarded;
    switch handles.options.model
    case 'bihertz'
        handles.T_result(curve_index-discarded,:) = {handles.file_names(curve_index),...
                           uint64(curve_index),...
                           handles.fit_results.initial_E_s,...
                           handles.fit_results.initial_E_h,...
                           handles.fit_results.initial_d_h,...
                           handles.fit_results.fit_E_s,...
                           handles.fit_results.fit_E_h,...
                           handles.fit_results.fit_d_h,...
                           handles.fit_results.rsquare_fit};

    case 'hertz'
        handles.T_result(curve_index-discarded,:) = {handles.file_names(curve_index),...
                           uint64(curve_index),...
                           handles.fit_results.EModul,...
                           handles.fit_results.gof_rsquare};
    end

    % change last listbox element                  
    it = handles.listbox1.String;
    it{curve_index,1} = sprintf('curve %3u  ->  processed',curve_index);
    handles.listbox1.String = it;
    
    % add one to current curve
    handles.current_curve = curve_index + 1;
    guidata(hObject,handles);
    
    % update progress values
    handles.progress.num_unprocessed = handles.progress.num_unprocessed -1;
    handles.progress.num_processed = handles.progress.num_processed +1; 

    % write process info
    [hObject,handles] = update_progress_info(hObject,handles);
    guidata(hObject,handles);
    
    % set current curve back to index of last curve
    handles.current_curve = handles.num_files;
                               
    % save dialog
    answer = questdlg({'Curve processing completed!',...
        'Do you want to save the results?'},...
        'Processing completed!','Yes','No','Yes');

    if strcmp(answer,'Yes')
        if strcmp(handles.edit_savepath.String,'     savepath')
            [file,path] = uiputfile({'*.tsv;*.xlsx','Save files (*.tsv,*.xlsx)';...
                '*.*','All Files (*.*)'});
            if path ~= 0
                savepath = fullfile(path,file);
                save_table(handles.T_result,'fileFormat','tsv','savepath',savepath);
                save_diffract = split(savepath,'.tsv');
                savepath_cell = strcat(save_diffract(1),'.xlsx');
                savepath = savepath_cell{1};
                if exist(savepath,'file') == 2
                    delete(savepath)
                end
                save_table(handles.T_result,'fileFormat','excel','savepath',savepath);
                handles.save_status = 1;
                handles.save_status_led.BackgroundColor = [0 1 0];
            end
        else 
            savepath = handles.edit_savepath.String;
            save_table(handles.T_result,'fileFormat','tsv','savepath',savepath);
            save_diffract = split(savepath,'.tsv');
            savepath = strcat(save_diffract,'.xlsx');
            save_table(handles.T_result,'fileFormat','excel','savepath',savepath);
            handles.save_status = 1;
            handles.save_status_led.BackgroundColor = [0 1 0];
        end
    end
end
delete(wb)
guidata(hObject,handles)


% --------------------------------------------------------------------
function map_axes_context_Callback(~, ~, ~)
% hObject    handle to map_axes_context (see GCBO)
% eventdata  reserved - to be defined in a future version of MATLAB
% handles    structure with handles and user data (see GUIDATA)


% --- Executes on selection change in fit_model_popup.
function fit_model_popup_Callback(hObject, ~, handles)
% hObject    handle to fit_model_popup (see GCBO)
% eventdata  reserved - to be defined in a future version of MATLAB
% handles    structure with handles and user data (see GUIDATA)

% Hints: contents = cellstr(get(hObject,'String')) returns fit_model_popup contents as cell array
%        contents{get(hObject,'Value')} returns selected item from fit_model_popup

% switch panels
switch hObject.Value
    case 1
        handles.uipanel5.Visible = 'on';
        handles.uipanel10.Visible = 'on';
        handles.hertz_fit_panel.Visible = 'off';
        handles.map_axes.Visible = 'off';
        handles.options.model = 'bihertz';
        % recreate T_results if exists
        if isfield(handles,'T_result')
        varTypes =  {'string','uint64','double','double','double',...
                             'double','double','double','double'};
        varNames = {'File_name','Index','initial_E_s_Pa','initial_E_h_Pa',...
                    'initial_d_h_m','fit_E_s_Pa','fit_E_h_Pa','fit_d_h_m','rsquare_fit'};
        handles.T_result = table('size',[handles.num_files 9],'VariableTypes',varTypes,'VariableNames',varNames);
        end
    case 2
        handles.uipanel5.Visible = 'off';
        handles.uipanel10.Visible = 'off';
        handles.hertz_fit_panel.Visible = 'on';
        handles.map_axes.Visible = 'on';
        handles.options.model = 'hertz';
        % recreate T_results if exists
        if isfield(handles,'T_result')
            varTypes =  {'string','uint64','double','double'};
            varNames = {'File_name','Index','EModul','rsquare_fit'};
            handles.T_result = table('size',[handles.num_files 4],'VariableTypes',varTypes,'VariableNames',varNames);
        end
end

try     % if curves are loaded
% draw new curve
switch handles.options.model
    case 'bihertz'
        [handles] = plot_bihertz(handles);
        guidata(hObject,handles);
    case 'hertz'
        [hObject,handles] = plot_hertz(hObject,handles);
        guidata(hObject,handles);
end

% fit data to processed curve and display fitresult
[hObject,handles] = curve_fit_functions(hObject,handles);
guidata(hObject,handles);

% update gui fit results
[hObject,handles] = update_fit_results(hObject,handles);
catch
   % if no curve is loaded don't do anything 
end
guidata(hObject,handles);



% --- Executes during object creation, after setting all properties.
function fit_model_popup_CreateFcn(hObject, ~, ~)
% hObject    handle to fit_model_popup (see GCBO)
% eventdata  reserved - to be defined in a future version of MATLAB
% handles    empty - handles not created until after all CreateFcns called

% Hint: popupmenu controls usually have a white background on Windows.
%       See ISPC and COMPUTER.
if ispc && isequal(get(hObject,'BackgroundColor'), get(0,'defaultUicontrolBackgroundColor'))
    set(hObject,'BackgroundColor','white');
end


% --------------------------------------------------------------------
function exit_Callback(~, ~, handles)
% hObject    handle to exit (see GCBO)
% eventdata  reserved - to be defined in a future version of MATLAB
% handles    structure with handles and user data (see GUIDATA)

answer = 'Yes';
if handles.save_status == 0
    answer = questdlg({'There are unsaved results.','Do you really want to exit the window?'},...
        'Exit request','Yes','No','No');
end

if strcmp(answer,'Yes')
        % Delete created folder and .zip of the ReadJPKMaps function
    if isfield(handles, 'loadtype') == 1
        if strcmp(handles.loadtype,'file')
            [filepath, name, ~] = fileparts(handles.edit_filepath.String);
            zipname = strcat(filepath, '\', name, '.zip');
            unzipfolder = strcat(filepath, '\', 'Forcemap');
            if exist(zipname, 'file') == 2
                delete (zipname)
            end
            if exist(unzipfolder, 'dir') == 7
                rmdir(unzipfolder, 's')
            end
        end
    end

    try
        delete(handles.figures.main_fig);
    catch 
        % nix
    end
    warning on
    delete(handles.figure1);
    delete(allchild(groot));
end

% --- Executes during object deletion, before destroying properties.
function figure1_DeleteFcn(~, ~, ~)
% hObject    handle to figure1 (see GCBO)
% eventdata  reserved - to be defined in a future version of MATLAB
% handles    structure with handles and user data (see GUIDATA)


% --- Executes on button press in button_folder.
function button_folder_Callback(hObject, ~, handles)
% hObject    handle to button_folder (see GCBO)
% eventdata  reserved - to be defined in a future version of MATLAB
% handles    structure with handles and user data (see GUIDATA)
[path] = uigetdir([],'Select folder with curve-files');

if ~isequal(path,0)
    set(handles.edit_filepath,'String',path);
    handles.loadtype = 'folder';
    guidata(hObject,handles)
end

% --- Close function for main_plot window.
function main_plot_CloseRequest(~,~,~)
   warndlg({'You are not allowed to close the main plot window this way!';...
       'The main plot window will be closed together with the processing window!'})


% --- Executes when user attempts to close figure1.
function figure1_CloseRequestFcn(~, eventdata, handles)
% hObject    handle to figure1 (see GCBO)
% eventdata  reserved - to be defined in a future version of MATLAB
% handles    structure with handles and user data (see GUIDATA)

% Hint: delete(hObject) closes the figure
exit_Callback(handles.exit,eventdata,handles);


% --- Executes on key press with focus on fit_depth and none of its controls.
function fit_depth_KeyPressFcn(~, ~, ~)
% hObject    handle to fit_depth (see GCBO)
% eventdata  structure with the following fields (see MATLAB.UI.CONTROL.UICONTROL)
%	Key: name of the key that was pressed, in lower case
%	Character: character interpretation of the key(s) that was pressed
%	Modifier: name(s) of the modifier key(s) (i.e., control, shift) pressed
% handles    structure with handles and user data (see GUIDATA)


% --- Executes on key press with focus on button_keep and none of its controls.
function button_keep_KeyPressFcn(hObject, eventdata, handles)
% hObject    handle to button_keep (see GCBO)
% eventdata  structure with the following fields (see MATLAB.UI.CONTROL.UICONTROL)
%	Key: name of the key that was pressed, in lower case
%	Character: character interpretation of the key(s) that was pressed
%	Modifier: name(s) of the modifier key(s) (i.e., control, shift) pressed
% handles    structure with handles and user data (see GUIDATA)
button_keep_Callback(hObject, eventdata, handles);



function hertz_fit_depth_Callback(hObject, ~, handles)
% hObject    handle to hertz_fit_depth (see GCBO)
% eventdata  reserved - to be defined in a future version of MATLAB
% handles    structure with handles and user data (see GUIDATA)
[hObject,handles] = update_patches_hertzfit(hObject,handles);
[hObject,handles] = curve_fit_functions(hObject,handles);
[hObject,handles] = update_fit_results(hObject,handles);
guidata(hObject,handles);

function hertz_fit_depth_DeleteFcn(~, ~, ~)
% hObject    handle to hertz_fit_depth (see GCBO)
% eventdata  reserved - to be defined in a future version of MATLAB
% handles    structure with handles and user data (see GUIDATA)



% Hints: get(hObject,'String') returns contents of hertz_fit_depth as text
%        str2double(get(hObject,'String')) returns contents of hertz_fit_depth as a double


% --- Executes during object creation, after setting all properties.
function hertz_fit_depth_CreateFcn(hObject, ~, ~)
% hObject    handle to hertz_fit_depth (see GCBO)
% eventdata  reserved - to be defined in a future version of MATLAB
% handles    empty - handles not created until after all CreateFcns called

% Hint: edit controls usually have a white background on Windows.
%       See ISPC and COMPUTER.
if ispc && isequal(get(hObject,'BackgroundColor'), get(0,'defaultUicontrolBackgroundColor'))
    set(hObject,'BackgroundColor','white');
end


% --- Executes when selected object is changed in baseline_btngroup.
function baseline_btngroup_SelectionChangedFcn(hObject, ~, handles)
% hObject    handle to the selected object in baseline_btngroup 
% eventdata  reserved - to be defined in a future version of MATLAB
% handles    structure with handles and user data (see GUIDATA)
SelectedMode = handles.baseline_btngroup.SelectedObject.String;
if strcmp(SelectedMode, 'none')
    handles.options.bihertz_baseline = 'none';
elseif strcmp(SelectedMode, 'Offset')
    handles.options.bihertz_baseline = 'offset';
else
    handles.options.bihertz_baseline = 'offset_and_tilt';
end

if isfield(handles, 'curves')
    
    %Update the graph with the new fit options
    [hObject,handles] = process_options(hObject,handles);
    %Plot the data as Bihertz or as Hertz
    switch handles.options.model
        case 'bihertz'
            [handles] = plot_bihertz(handles);
            guidata(hObject,handles);
        case 'hertz'
            [hObject,handles] = plot_hertz(hObject,handles);
            guidata(hObject,handles);
    end
    
    if strcmp(SelectedMode, 'none')
        curve_str = sprintf('curve%u',handles.current_curve);
        handles.proc_curves.(curve_str) = handles.curves.(curve_str);
    end
    
    % fit data to processed curve and display fitresult
    [hObject,handles] = curve_fit_functions(hObject,handles);
    guidata(hObject,handles);

    % update gui fit results
    [hObject,handles] = update_fit_results(hObject,handles);
        
else
    %Nothing
end
guidata(hObject,handles)
    


    


% --- Executes during object creation, after setting all properties.
function baseline_btngroup_CreateFcn(~, ~, handles)
% hObject    handle to baseline_btngroup (see GCBO)
% eventdata  reserved - to be defined in a future version of MATLAB
% handles    empty - handles not created until after all CreateFcns called
handles.baseline_btngroup.SelectedObject.Tag = 'offset_and_tilt';



function save_status_led_Callback(~, ~, ~)
% hObject    handle to save_status_led (see GCBO)
% eventdata  reserved - to be defined in a future version of MATLAB
% handles    structure with handles and user data (see GUIDATA)

% Hints: get(hObject,'String') returns contents of save_status_led as text
%        str2double(get(hObject,'String')) returns contents of save_status_led as a double


% --- Executes during object creation, after setting all properties.
function save_status_led_CreateFcn(hObject, ~, ~)
% hObject    handle to save_status_led (see GCBO)
% eventdata  reserved - to be defined in a future version of MATLAB
% handles    empty - handles not created until after all CreateFcns called

% Hint: edit controls usually have a white background on Windows.
%       See ISPC and COMPUTER.
if ispc && isequal(get(hObject,'BackgroundColor'), get(0,'defaultUicontrolBackgroundColor'))
    set(hObject,'BackgroundColor','white');
end


% --- Executes when figure1 is resized.
function figure1_SizeChangedFcn(hObject, ~, handles)
% hObject    handle to figure1 (see GCBO)
% eventdata  reserved - to be defined in a future version of MATLAB
% handles    structure with handles and user data (see GUIDATA)

% make save status led square
window_width = handles.figure1.Position(3);
led_width = (window_width*handles.def_led_width)/handles.def_wind_width;
handles.save_status_led.Position(3) = led_width;
handles.save_status_led.Position(4) = led_width;    % square led shape

% correct led x-y-Position
window_height = handles.figure1.Position(4);
x_led = (window_width*handles.def_led_x)/handles.def_wind_width;
y_led = (window_height*handles.def_led_y)/handles.def_wind_height;
handles.save_status_led.Position(1) = x_led;
handles.save_status_led.Position(2) = y_led;
guidata(hObject,handles);


% --- Executes on selection change in image_channels_popup.
function image_channels_popup_Callback(hObject, ~, handles)
% hObject    handle to image_channels_popup (see GCBO)
% eventdata  reserved - to be defined in a future version of MATLAB
% handles    structure with handles and user data (see GUIDATA)

% Hints: contents = cellstr(get(hObject,'String')) returns image_channels_popup contents as cell array
%        contents{get(hObject,'Value')} returns selected item from image_channels_popup
[hObject,handles] = checker_helpf(hObject,handles);
channel_num = hObject.Value;
channel_string = handles.channel_names{channel_num};
channel_interpolation = handles.interpolation_type;
if ~strcmp(channel_interpolation,'none')
    interpolation_string = sprintf('_%s_interpolation',channel_interpolation);
else
    interpolation_string = '';
end
if strcmp(channel_string,'height')
    channel_image = handles.map_images.height.(sprintf('absolute_%s_data%s',...
    channel_string,interpolation_string));
else
    channel_image = handles.map_images.(channel_string).(sprintf('%s_data%s',...
        channel_string,interpolation_string));
end
axes(handles.map_axes);
imshow(flip(channel_image,1),[],'InitialMagnification','fit','XData',[1 handles.map_info.x_pixel],'YData',[1 handles.map_info.y_pixel]);
handles.map_axes.YDir = 'normal';
handles = update_curve_marker(handles);
hline = findall(gca,'Type','image');
set(hline(1),'uicontextmenu',handles.map_axes_context);
set_afm_gold;
guidata(hObject,handles);

% --- Executes during object creation, after setting all properties.
function image_channels_popup_CreateFcn(hObject, ~, ~)
% hObject    handle to image_channels_popup (see GCBO)
% eventdata  reserved - to be defined in a future version of MATLAB
% handles    empty - handles not created until after all CreateFcns called

% Hint: popupmenu controls usually have a white background on Windows.
%       See ISPC and COMPUTER.
if ispc && isequal(get(hObject,'BackgroundColor'), get(0,'defaultUicontrolBackgroundColor'))
    set(hObject,'BackgroundColor','white');
end


% --------------------------------------------------------------------
function interpolation_type_Callback(~, ~, ~)
% hObject    handle to interpolation_type (see GCBO)
% eventdata  reserved - to be defined in a future version of MATLAB
% handles    structure with handles and user data (see GUIDATA)


% --------------------------------------------------------------------
function none_Callback(hObject, ~, handles)
% hObject    handle to none (see GCBO)
% eventdata  reserved - to be defined in a future version of MATLAB
% handles    structure with handles and user data (see GUIDATA)
[hObject,handles] = checker_helpf(hObject,handles);
handles.interpolation_type = 'none';
channel_num = handles.image_channels_popup.Value;
channel_string = handles.channel_names{channel_num};
channel_interpolation = handles.interpolation_type;
if ~strcmp(channel_interpolation,'none')
    interpolation_string = sprintf('_%s_interpolation',channel_interpolation);
else
    interpolation_string = '';
end

if strcmp(channel_string,'height')
    channel_image = handles.map_images.height.(sprintf('absolute_%s_data%s',...
    channel_string,interpolation_string));
else
    channel_image = handles.map_images.(channel_string).(sprintf('%s_data%s',...
        channel_string,interpolation_string));
end

axes(handles.map_axes);
imshow(flip(channel_image,1),[],'InitialMagnification','fit','XData',[1 handles.map_info.x_pixel],'YData',[1 handles.map_info.y_pixel]);
handles.map_axes.YDir = 'normal';
handles = update_curve_marker(handles);
hline = findall(gca,'Type','image');
set(hline(1),'uicontextmenu',handles.map_axes_context);
set_afm_gold;
guidata(hObject,handles);


% --------------------------------------------------------------------
function linear_Callback(hObject, ~, handles)
% hObject    handle to linear (see GCBO)
% eventdata  reserved - to be defined in a future version of MATLAB
% handles    structure with handles and user data (see GUIDATA)
[hObject,handles] = checker_helpf(hObject,handles);
handles.interpolation_type = 'linear';
channel_num = handles.image_channels_popup.Value;
channel_string = handles.channel_names{channel_num};
channel_interpolation = handles.interpolation_type;
if ~strcmp(channel_interpolation,'none')
    interpolation_string = sprintf('_%s_interpolation',channel_interpolation);
else
    interpolation_string = '';
end
if strcmp(channel_string,'height')
    channel_image = handles.map_images.height.(sprintf('absolute_%s_data%s',...
    channel_string,interpolation_string));
else
    channel_image = handles.map_images.(channel_string).(sprintf('%s_data%s',...
        channel_string,interpolation_string));
end
axes(handles.map_axes);
imshow(flip(channel_image,1),[],'InitialMagnification','fit','XData',[1 handles.map_info.x_pixel],'YData',[1 handles.map_info.y_pixel]);
handles.map_axes.YDir = 'normal';
handles = update_curve_marker(handles);
hline = findall(gca,'Type','image');
set(hline(1),'uicontextmenu',handles.map_axes_context);
set_afm_gold;
guidata(hObject,handles);


% --------------------------------------------------------------------
function bicubic_Callback(hObject, ~, handles)
% hObject    handle to bicubic (see GCBO)
% eventdata  reserved - to be defined in a future version of MATLAB
% handles    structure with handles and user data (see GUIDATA)
[hObject,handles] = checker_helpf(hObject,handles);
handles.interpolation_type = 'bicubic';
channel_num = handles.image_channels_popup.Value;
channel_string = handles.channel_names{channel_num};
channel_interpolation = handles.interpolation_type;
if ~strcmp(channel_interpolation,'none')
    interpolation_string = sprintf('_%s_interpolation',channel_interpolation);
else
    interpolation_string = '';
end
if strcmp(channel_string,'height')
    channel_image = handles.map_images.height.(sprintf('absolute_%s_data%s',...
    channel_string,interpolation_string));
else
    channel_image = handles.map_images.(channel_string).(sprintf('%s_data%s',...
        channel_string,interpolation_string));
end
axes(handles.map_axes);
imshow(flip(channel_image,1),[],'InitialMagnification','fit','XData',[1 handles.map_info.x_pixel],'YData',[1 handles.map_info.y_pixel]);
handles.map_axes.YDir = 'normal';
handles = update_curve_marker(handles);
hline = findall(gca,'Type','image');
set(hline(1),'uicontextmenu',handles.map_axes_context);
set_afm_gold;
guidata(hObject,handles);


% --- Executes during object creation, after setting all properties.
function map_axes_CreateFcn(~, ~, ~)
% hObject    handle to map_axes (see GCBO)
% eventdata  reserved - to be defined in a future version of MATLAB
% handles    empty - handles not created until after all CreateFcns called

% Hint: place code in OpeningFcn to populate map_axes






% ---- checker_helper function ------
function [hObject,handles] = checker_helpf(hObject,handles)
    button_tag = hObject.Tag;
    switch button_tag
        case 'none'
            handles.none.Checked = 'on';
            handles.linear.Checked  = 'off';
            handles.bicubic.Checked = 'off';
        case 'linear'
            handles.none.Checked = 'off';
            handles.linear.Checked  = 'on';
            handles.bicubic.Checked = 'off';
        case 'bicubic'
            handles.none.Checked = 'off';
            handles.linear.Checked  = 'off';
            handles.bicubic.Checked = 'on';
    end
guidata(hObject,handles);
    
    
% -------- bihertz_channel_helpf -----------


% --- Executes when selected object is changed in btngroup_contact.
function btngroup_contact_SelectionChangedFcn(hObject, eventdata, handles)
% hObject    handle to the selected object in btngroup_contact 
% eventdata  reserved - to be defined in a future version of MATLAB
% handles    structure with handles and user data (see GUIDATA)

%Curve is redrawn with a different Contactpoint finding model. This is
%checked in the contact point function during the process_options

%Process curve
[hObject,handles] = process_options(hObject,handles);

% draw new curve
switch handles.options.model
    case 'bihertz'
        [handles] = plot_bihertz(handles);
        guidata(hObject,handles);
    case 'hertz'
        [hObject,handles] = plot_hertz(hObject,handles);
        guidata(hObject,handles);
end

% fit data to processed curve and display fitresult
[hObject,handles] = curve_fit_functions(hObject,handles);
guidata(hObject,handles);

% update gui fit results
[hObject,handles] = update_fit_results(hObject,handles);
guidata(hObject,handles);



% --- Creates and returns a handle to the GUI figure. 
function h1 = bihertz_gui_export_LayoutFcn(policy)
% policy - create a new figure or use a singleton. 'new' or 'reuse'.

persistent hsingleton;
if strcmpi(policy, 'reuse') & ishandle(hsingleton)
    h1 = hsingleton;
    return;
end

appdata = [];
appdata.GUIDEOptions = struct(...
    'active_h', [], ...
    'taginfo', struct(...
    'figure', 2, ...
    'text', 56, ...
    'pushbutton', 16, ...
    'listbox', 2, ...
    'uipanel', 21, ...
    'edit', 8, ...
    'popupmenu', 3, ...
    'uibuttongroup', 9, ...
    'axes', 2, ...
    'radiobutton', 15), ...
    'override', 1, ...
    'release', [], ...
    'resize', 'simple', ...
    'accessibility', 'callback', ...
    'mfile', 1, ...
    'callbacks', 1, ...
    'singleton', 1, ...
    'syscolorfig', 1, ...
    'blocking', 0, ...
    'lastSavedFile', 'C:\Users\Bastian\FH München\Promotion\Canterhm_Repositories\CANTER_Matlab_library\GUI-files\bihertz_fit\bihertz_gui_export.m', ...
    'lastFilename', 'C:\Users\Bastian\FH München\Promotion\Matlab - function library\CANTER_MATLAB_library\GUI-files\bihertz_fit\bihertz_gui.fig');
appdata.lastValidTag = 'figure1';
appdata.GUIDELayoutEditor = [];
appdata.initTags = struct(...
    'handle', [], ...
    'tag', 'figure1');

h1 = figure(...
'PaperUnits','inches',...
'Units','points',...
'Position',[509 -1.5 962 509.5],...
'Visible',get(0,'defaultfigureVisible'),...
'Color',get(0,'defaultfigureColor'),...
'CloseRequestFcn',@(hObject,eventdata)bihertz_gui_export('figure1_CloseRequestFcn',hObject,eventdata,guidata(hObject)),...
'CurrentAxesMode','manual',...
'ResizeFcn',@(hObject,eventdata)bihertz_gui('figure1_SizeChangedFcn',hObject,eventdata,guidata(hObject)),...
'IntegerHandle','off',...
'MenuBar','none',...
'Name','bihertz_gui',...
'NumberTitle','off',...
'HandleVisibility','callback',...
'DeleteFcn',@(hObject,eventdata)bihertz_gui_export('figure1_DeleteFcn',hObject,eventdata,guidata(hObject)),...
'Tag','figure1',...
'Resize',get(0,'defaultfigureResize'),...
'PaperPosition',get(0,'defaultfigurePaperPosition'),...
'PaperSize',[8.5 11],...
'PaperSizeMode',get(0,'defaultfigurePaperSizeMode'),...
'PaperType','usletter',...
'PaperTypeMode',get(0,'defaultfigurePaperTypeMode'),...
'PaperUnitsMode',get(0,'defaultfigurePaperUnitsMode'),...
'ScreenPixelsPerInchMode','manual',...
'CreateFcn', {@local_CreateFcn, blanks(0), appdata} );

appdata = [];
appdata.lastValidTag = 'map_axes';

h2 = axes(...
'Parent',h1,...
'FontUnits',get(0,'defaultaxesFontUnits'),...
'Units',get(0,'defaultaxesUnits'),...
'CameraPosition',[0.5 0.5 9.16025403784439],...
'CameraPositionMode',get(0,'defaultaxesCameraPositionMode'),...
'CameraTarget',[0.5 0.5 0.5],...
'CameraTargetMode',get(0,'defaultaxesCameraTargetMode'),...
'CameraViewAngle',6.60861036031192,...
'CameraViewAngleMode',get(0,'defaultaxesCameraViewAngleMode'),...
'PlotBoxAspectRatio',[1 0.977358490566038 0.977358490566038],...
'PlotBoxAspectRatioMode',get(0,'defaultaxesPlotBoxAspectRatioMode'),...
'Colormap',[0.2422 0.1504 0.6603;0.250390476190476 0.164995238095238 0.707614285714286;0.257771428571429 0.181780952380952 0.751138095238095;0.264728571428571 0.197757142857143 0.795214285714286;0.270647619047619 0.21467619047619 0.836371428571429;0.275114285714286 0.234238095238095 0.870985714285714;0.2783 0.255871428571429 0.899071428571429;0.280333333333333 0.278233333333333 0.9221;0.281338095238095 0.300595238095238 0.941376190476191;0.281014285714286 0.322757142857143 0.957885714285714;0.279466666666667 0.344671428571429 0.971676190476191;0.275971428571429 0.366680952380952 0.982904761904762;0.269914285714286 0.3892 0.9906;0.260242857142857 0.412328571428571 0.995157142857143;0.244033333333333 0.435833333333333 0.998833333333333;0.220642857142857 0.460257142857143 0.997285714285714;0.196333333333333 0.484719047619048 0.989152380952381;0.183404761904762 0.507371428571429 0.979795238095238;0.178642857142857 0.528857142857143 0.968157142857143;0.176438095238095 0.549904761904762 0.952019047619048;0.168742857142857 0.570261904761905 0.935871428571428;0.154 0.5902 0.9218;0.146028571428571 0.609119047619048 0.907857142857143;0.13802380952381 0.627628571428572 0.897290476190476;0.124814285714286 0.645928571428571 0.888342857142857;0.111252380952381 0.6635 0.876314285714286;0.0952095238095238 0.679828571428571 0.859780952380952;0.0688714285714285 0.694771428571429 0.839357142857143;0.0296666666666667 0.708166666666667 0.816333333333333;0.00357142857142857 0.720266666666667 0.7917;0.00665714285714287 0.731214285714286 0.766014285714286;0.0433285714285715 0.741095238095238 0.739409523809524;0.096395238095238 0.75 0.712038095238095;0.140771428571429 0.7584 0.684157142857143;0.1717 0.766961904761905 0.655442857142857;0.193766666666667 0.775766666666667 0.6251;0.216085714285714 0.7843 0.5923;0.246957142857143 0.791795238095238 0.556742857142857;0.290614285714286 0.797290476190476 0.518828571428572;0.340642857142857 0.8008 0.478857142857143;0.3909 0.802871428571428 0.435447619047619;0.445628571428572 0.802419047619048 0.390919047619048;0.5044 0.7993 0.348;0.561561904761905 0.794233333333333 0.304480952380953;0.617395238095238 0.787619047619048 0.261238095238095;0.671985714285714 0.779271428571429 0.2227;0.7242 0.769842857142857 0.191028571428571;0.773833333333333 0.759804761904762 0.164609523809524;0.820314285714286 0.749814285714286 0.153528571428571;0.863433333333333 0.7406 0.159633333333333;0.903542857142857 0.733028571428571 0.177414285714286;0.939257142857143 0.728785714285714 0.209957142857143;0.972757142857143 0.729771428571429 0.239442857142857;0.995647619047619 0.743371428571429 0.237147619047619;0.996985714285714 0.765857142857143 0.219942857142857;0.995204761904762 0.789252380952381 0.202761904761905;0.9892 0.813566666666667 0.188533333333333;0.978628571428571 0.838628571428572 0.176557142857143;0.967647619047619 0.8639 0.164290476190476;0.961009523809524 0.889019047619048 0.153676190476191;0.959671428571429 0.913457142857143 0.142257142857143;0.962795238095238 0.937338095238095 0.126509523809524;0.969114285714286 0.960628571428571 0.106361904761905;0.9769 0.9839 0.0805],...
'ColormapMode',get(0,'defaultaxesColormapMode'),...
'Alphamap',[0 0.0159 0.0317 0.0476 0.0635 0.0794 0.0952 0.1111 0.127 0.1429 0.1587 0.1746 0.1905 0.2063 0.2222 0.2381 0.254 0.2698 0.2857 0.3016 0.3175 0.3333 0.3492 0.3651 0.381 0.3968 0.4127 0.4286 0.4444 0.4603 0.4762 0.4921 0.5079 0.5238 0.5397 0.5556 0.5714 0.5873 0.6032 0.619 0.6349 0.6508 0.6667 0.6825 0.6984 0.7143 0.7302 0.746 0.7619 0.7778 0.7937 0.8095 0.8254 0.8413 0.8571 0.873 0.8889 0.9048 0.9206 0.9365 0.9524 0.9683 0.9841 1],...
'AlphamapMode',get(0,'defaultaxesAlphamapMode'),...
'XTick',[0 0.2 0.4 0.6 0.8 1],...
'XTickMode',get(0,'defaultaxesXTickMode'),...
'XTickLabel',{  '0'; '0.2'; '0.4'; '0.6'; '0.8'; '1' },...
'XTickLabelMode',get(0,'defaultaxesXTickLabelMode'),...
'YTick',[0 0.2 0.4 0.6 0.8 1],...
'YTickMode',get(0,'defaultaxesYTickMode'),...
'YTickLabel',{  '0'; '0.2'; '0.4'; '0.6'; '0.8'; '1' },...
'YTickLabelMode',get(0,'defaultaxesYTickLabelMode'),...
'CameraMode',get(0,'defaultaxesCameraMode'),...
'DataSpaceMode',get(0,'defaultaxesDataSpaceMode'),...
'ColorSpaceMode',get(0,'defaultaxesColorSpaceMode'),...
'DecorationContainerMode',get(0,'defaultaxesDecorationContainerMode'),...
'ChildContainerMode',get(0,'defaultaxesChildContainerMode'),...
'XRulerMode',get(0,'defaultaxesXRulerMode'),...
'YRulerMode',get(0,'defaultaxesYRulerMode'),...
'ZRulerMode',get(0,'defaultaxesZRulerMode'),...
'AmbientLightSourceMode',get(0,'defaultaxesAmbientLightSourceMode'),...
'Position',[0.0311258278145695 0.0390070921985816 0.206622516556291 0.380614657210402],...
'ActivePositionProperty','position',...
'ActivePositionPropertyMode',get(0,'defaultaxesActivePositionPropertyMode'),...
'FontSize',9.5,...
'FontSizeMode',get(0,'defaultaxesFontSizeMode'),...
'SortMethod','childorder',...
'SortMethodMode',get(0,'defaultaxesSortMethodMode'),...
'Visible','off',...
'CreateFcn', {@local_CreateFcn, @(hObject,eventdata)bihertz_gui_export('map_axes_CreateFcn',hObject,eventdata,guidata(hObject)), appdata} ,...
'Tag','map_axes');

h3 = get(h2,'title');

set(h3,...
'Parent',h2,...
'Units','data',...
'FontUnits','points',...
'DecorationContainer',[],...
'DecorationContainerMode','auto',...
'Color',[0 0 0],...
'ColorMode','auto',...
'Position',[0.50000062438677 1.01008687258687 0.500000000000007],...
'PositionMode','auto',...
'Interpreter','tex',...
'InterpreterMode','auto',...
'Rotation',0,...
'RotationMode','auto',...
'FontName','Helvetica',...
'FontNameMode','auto',...
'FontUnitsMode','auto',...
'FontSize',10.45,...
'FontSizeMode','auto',...
'FontAngle','normal',...
'FontAngleMode','auto',...
'FontWeight','bold',...
'FontWeightMode','auto',...
'HorizontalAlignment','center',...
'HorizontalAlignmentMode','auto',...
'VerticalAlignment','bottom',...
'VerticalAlignmentMode','auto',...
'EdgeColor','none',...
'EdgeColorMode','auto',...
'LineStyle','-',...
'LineStyleMode','auto',...
'LineWidth',0.5,...
'LineWidthMode','auto',...
'BackgroundColor','none',...
'BackgroundColorMode','auto',...
'Margin',3,...
'MarginMode','auto',...
'Clipping','off',...
'ClippingMode','auto',...
'Layer','middle',...
'LayerMode','auto',...
'FontSmoothing','on',...
'FontSmoothingMode','auto',...
'UnitsMode','auto',...
'IncludeRenderer','on',...
'IsContainer','off',...
'IsContainerMode','auto',...
'DimensionNames',{  'X' 'Y' 'Z' },...
'DimensionNamesMode','auto',...
'XLimInclude','on',...
'XLimIncludeMode','auto',...
'YLimInclude','on',...
'YLimIncludeMode','auto',...
'ZLimInclude','on',...
'ZLimIncludeMode','auto',...
'CLimInclude','on',...
'CLimIncludeMode','auto',...
'ALimInclude','on',...
'ALimIncludeMode','auto',...
'Description','Axes Title',...
'DescriptionMode','auto',...
'Visible','off',...
'VisibleMode','auto',...
'Serializable','on',...
'SerializableMode','auto',...
'HandleVisibility','off',...
'HandleVisibilityMode','auto',...
'TransformForPrintFcnImplicitInvoke','on',...
'TransformForPrintFcnImplicitInvokeMode','auto',...
'HG1EraseMode','auto',...
'BusyAction','queue',...
'Interruptible','on',...
'HitTest','on',...
'HitTestMode','auto',...
'PickableParts','visible',...
'PickablePartsMode','auto');

h4 = get(h2,'xlabel');

set(h4,...
'Parent',h2,...
'Units','data',...
'FontUnits','points',...
'DecorationContainer',[],...
'DecorationContainerMode','auto',...
'Color',[0.15 0.15 0.15],...
'ColorMode','auto',...
'Position',[0.500000476837158 -0.0831402812992131 7.105427357601e-15],...
'PositionMode','auto',...
'Interpreter','tex',...
'InterpreterMode','auto',...
'Rotation',0,...
'RotationMode','auto',...
'FontName','Helvetica',...
'FontNameMode','auto',...
'FontUnitsMode','auto',...
'FontSize',10.45,...
'FontSizeMode','auto',...
'FontAngle','normal',...
'FontAngleMode','auto',...
'FontWeight','normal',...
'FontWeightMode','auto',...
'HorizontalAlignment','center',...
'HorizontalAlignmentMode','auto',...
'VerticalAlignment','top',...
'VerticalAlignmentMode','auto',...
'EdgeColor','none',...
'EdgeColorMode','auto',...
'LineStyle','-',...
'LineStyleMode','auto',...
'LineWidth',0.5,...
'LineWidthMode','auto',...
'BackgroundColor','none',...
'BackgroundColorMode','auto',...
'Margin',3,...
'MarginMode','auto',...
'Clipping','off',...
'ClippingMode','auto',...
'Layer','back',...
'LayerMode','auto',...
'FontSmoothing','on',...
'FontSmoothingMode','auto',...
'UnitsMode','auto',...
'IncludeRenderer','on',...
'IsContainer','off',...
'IsContainerMode','auto',...
'DimensionNames',{  'X' 'Y' 'Z' },...
'DimensionNamesMode','auto',...
'XLimInclude','on',...
'XLimIncludeMode','auto',...
'YLimInclude','on',...
'YLimIncludeMode','auto',...
'ZLimInclude','on',...
'ZLimIncludeMode','auto',...
'CLimInclude','on',...
'CLimIncludeMode','auto',...
'ALimInclude','on',...
'ALimIncludeMode','auto',...
'Description','AxisRulerBase Label',...
'DescriptionMode','auto',...
'Visible','off',...
'VisibleMode','auto',...
'Serializable','on',...
'SerializableMode','auto',...
'HandleVisibility','off',...
'HandleVisibilityMode','auto',...
'TransformForPrintFcnImplicitInvoke','on',...
'TransformForPrintFcnImplicitInvokeMode','auto',...
'HG1EraseMode','auto',...
'BusyAction','queue',...
'Interruptible','on',...
'HitTest','on',...
'HitTestMode','auto',...
'PickableParts','visible',...
'PickablePartsMode','auto');

h5 = get(h2,'ylabel');

set(h5,...
'Parent',h2,...
'Units','data',...
'FontUnits','points',...
'DecorationContainer',[],...
'DecorationContainerMode','auto',...
'Color',[0.15 0.15 0.15],...
'ColorMode','auto',...
'Position',[-0.0976100608687731 0.500000476837158 7.105427357601e-15],...
'PositionMode','auto',...
'Interpreter','tex',...
'InterpreterMode','auto',...
'Rotation',90,...
'RotationMode','auto',...
'FontName','Helvetica',...
'FontNameMode','auto',...
'FontUnitsMode','auto',...
'FontSize',10.45,...
'FontSizeMode','auto',...
'FontAngle','normal',...
'FontAngleMode','auto',...
'FontWeight','normal',...
'FontWeightMode','auto',...
'HorizontalAlignment','center',...
'HorizontalAlignmentMode','auto',...
'VerticalAlignment','bottom',...
'VerticalAlignmentMode','auto',...
'EdgeColor','none',...
'EdgeColorMode','auto',...
'LineStyle','-',...
'LineStyleMode','auto',...
'LineWidth',0.5,...
'LineWidthMode','auto',...
'BackgroundColor','none',...
'BackgroundColorMode','auto',...
'Margin',3,...
'MarginMode','auto',...
'Clipping','off',...
'ClippingMode','auto',...
'Layer','back',...
'LayerMode','auto',...
'FontSmoothing','on',...
'FontSmoothingMode','auto',...
'UnitsMode','auto',...
'IncludeRenderer','on',...
'IsContainer','off',...
'IsContainerMode','auto',...
'DimensionNames',{  'X' 'Y' 'Z' },...
'DimensionNamesMode','auto',...
'XLimInclude','on',...
'XLimIncludeMode','auto',...
'YLimInclude','on',...
'YLimIncludeMode','auto',...
'ZLimInclude','on',...
'ZLimIncludeMode','auto',...
'CLimInclude','on',...
'CLimIncludeMode','auto',...
'ALimInclude','on',...
'ALimIncludeMode','auto',...
'Description','AxisRulerBase Label',...
'DescriptionMode','auto',...
'Visible','off',...
'VisibleMode','auto',...
'Serializable','on',...
'SerializableMode','auto',...
'HandleVisibility','off',...
'HandleVisibilityMode','auto',...
'TransformForPrintFcnImplicitInvoke','on',...
'TransformForPrintFcnImplicitInvokeMode','auto',...
'HG1EraseMode','auto',...
'BusyAction','queue',...
'Interruptible','on',...
'HitTest','on',...
'HitTestMode','auto',...
'PickableParts','visible',...
'PickablePartsMode','auto');

h6 = get(h2,'zlabel');

set(h6,...
'Parent',h2,...
'Units','data',...
'FontUnits','points',...
'DecorationContainer',[],...
'DecorationContainerMode','auto',...
'Color',[0.15 0.15 0.15],...
'ColorMode','auto',...
'Position',[0 0 0],...
'PositionMode','auto',...
'Interpreter','tex',...
'InterpreterMode','auto',...
'Rotation',0,...
'RotationMode','auto',...
'FontName','Helvetica',...
'FontNameMode','auto',...
'FontUnitsMode','auto',...
'FontSize',10,...
'FontSizeMode','auto',...
'FontAngle','normal',...
'FontAngleMode','auto',...
'FontWeight','normal',...
'FontWeightMode','auto',...
'HorizontalAlignment','left',...
'HorizontalAlignmentMode','auto',...
'VerticalAlignment','middle',...
'VerticalAlignmentMode','auto',...
'EdgeColor','none',...
'EdgeColorMode','auto',...
'LineStyle','-',...
'LineStyleMode','auto',...
'LineWidth',0.5,...
'LineWidthMode','auto',...
'BackgroundColor','none',...
'BackgroundColorMode','auto',...
'Margin',3,...
'MarginMode','auto',...
'Clipping','off',...
'ClippingMode','auto',...
'Layer','middle',...
'LayerMode','auto',...
'FontSmoothing','on',...
'FontSmoothingMode','auto',...
'UnitsMode','auto',...
'IncludeRenderer','on',...
'IsContainer','off',...
'IsContainerMode','auto',...
'DimensionNames',{  'X' 'Y' 'Z' },...
'DimensionNamesMode','auto',...
'XLimInclude','on',...
'XLimIncludeMode','auto',...
'YLimInclude','on',...
'YLimIncludeMode','auto',...
'ZLimInclude','on',...
'ZLimIncludeMode','auto',...
'CLimInclude','on',...
'CLimIncludeMode','auto',...
'ALimInclude','on',...
'ALimIncludeMode','auto',...
'Description','AxisRulerBase Label',...
'DescriptionMode','auto',...
'Visible','off',...
'VisibleMode','auto',...
'Serializable','on',...
'SerializableMode','auto',...
'HandleVisibility','off',...
'HandleVisibilityMode','auto',...
'TransformForPrintFcnImplicitInvoke','on',...
'TransformForPrintFcnImplicitInvokeMode','auto',...
'HG1EraseMode','auto',...
'BusyAction','queue',...
'Interruptible','on',...
'HitTest','on',...
'HitTestMode','auto',...
'PickableParts','visible',...
'PickablePartsMode','auto');

appdata = [];
appdata.lastValidTag = 'hertz_fit_panel';

h7 = uipanel(...
'Parent',h1,...
'FontUnits','normalized',...
'Units',get(0,'defaultuipanelUnits'),...
'Title','Hertz-Fit',...
'Visible','off',...
'ResizeFcn',blanks(0),...
'ButtonDownFcn',blanks(0),...
'CreateFcn', {@local_CreateFcn, blanks(0), appdata} ,...
'DeleteFcn',blanks(0),...
'Tag','hertz_fit_panel',...
'Position',[0.471662468513854 0.0373303167420815 0.156801007556675 0.391402714932127],...
'FontSize',0.043010752688172);

appdata = [];
appdata.lastValidTag = 'hertz_fit_depth';

h8 = uicontrol(...
'Parent',h7,...
'Units','normalized',...
'FontUnits','normalized',...
'String','1',...
'Style','edit',...
'Position',[0.118367346938776 0.756838905775076 0.244897959183673 0.08],...
'BackgroundColor',[1 1 1],...
'Callback',@(hObject,eventdata)bihertz_gui_export('hertz_fit_depth_Callback',hObject,eventdata,guidata(hObject)),...
'Children',[],...
'CreateFcn', {@local_CreateFcn, @(hObject,eventdata)bihertz_gui_export('hertz_fit_depth_CreateFcn',hObject,eventdata,guidata(hObject)), appdata} ,...
'DeleteFcn',@(hObject,eventdata)bihertz_gui_export('hertz_fit_depth_DeleteFcn',hObject,eventdata,guidata(hObject)),...
'Tag','hertz_fit_depth',...
'KeyPressFcn',blanks(0),...
'FontSize',0.611586994565717);

appdata = [];
appdata.lastValidTag = 'hertz_gof';

h9 = uicontrol(...
'Parent',h7,...
'Units','normalized',...
'FontUnits','normalized',...
'String','none',...
'Style','text',...
'Position',[0.118367346938776 0.233081261215073 0.244897959183673 0.08],...
'BackgroundColor',[1 1 1],...
'Children',[],...
'Enable','inactive',...
'ButtonDownFcn',blanks(0),...
'CreateFcn', {@local_CreateFcn, blanks(0), appdata} ,...
'DeleteFcn',blanks(0),...
'Tag','hertz_gof',...
'FontSize',0.55);

appdata = [];
appdata.lastValidTag = 'text53';

h10 = uicontrol(...
'Parent',h7,...
'Units','normalized',...
'FontUnits','normalized',...
'HorizontalAlignment','left',...
'String','Goodness of Fit',...
'Style','text',...
'Position',[0.114285714285714 0.305370417841579 0.546938775510204 0.0662650602409638],...
'Children',[],...
'ButtonDownFcn',blanks(0),...
'CreateFcn', {@local_CreateFcn, blanks(0), appdata} ,...
'DeleteFcn',blanks(0),...
'Tag','text53',...
'FontSize',0.611586994565717);

appdata = [];
appdata.lastValidTag = 'text49';

h11 = uicontrol(...
'Parent',h7,...
'Units','normalized',...
'FontUnits','normalized',...
'HorizontalAlignment','left',...
'String','kPa',...
'Style','text',...
'Position',[0.395918367346939 0.441727395905812 0.244897959183673 0.0602409638554217],...
'Children',[],...
'ButtonDownFcn',blanks(0),...
'CreateFcn', {@local_CreateFcn, blanks(0), appdata} ,...
'DeleteFcn',blanks(0),...
'Tag','text49',...
'FontSize',0.67274569402229);

appdata = [];
appdata.lastValidTag = 'hertz_EModul';

h12 = uicontrol(...
'Parent',h7,...
'Units','normalized',...
'FontUnits','normalized',...
'String','none',...
'Style','text',...
'Position',[0.118367346938776 0.434650455927052 0.244897959183673 0.08],...
'BackgroundColor',[1 1 1],...
'Children',[],...
'Enable','inactive',...
'ButtonDownFcn',blanks(0),...
'CreateFcn', {@local_CreateFcn, blanks(0), appdata} ,...
'DeleteFcn',blanks(0),...
'Tag','hertz_EModul',...
'FontSize',0.55);

appdata = [];
appdata.lastValidTag = 'text47';

h13 = uicontrol(...
'Parent',h7,...
'Units','normalized',...
'FontUnits','normalized',...
'HorizontalAlignment','left',...
'String','Young''s Modulus',...
'Style','text',...
'Position',[0.114285714285714 0.514016552532318 0.591836734693878 0.0662650602409639],...
'Children',[],...
'ButtonDownFcn',blanks(0),...
'CreateFcn', {@local_CreateFcn, blanks(0), appdata} ,...
'DeleteFcn',blanks(0),...
'Tag','text47',...
'FontSize',0.611586994565717);

appdata = [];
appdata.lastValidTag = 'text46';

h14 = uicontrol(...
'Parent',h7,...
'Units','normalized',...
'FontUnits','normalized',...
'HorizontalAlignment','left',...
'String','µm',...
'Style','text',...
'Position',[0.395918367346939 0.77710843373494 0.244897959183673 0.0602409638554217],...
'Children',[],...
'ButtonDownFcn',blanks(0),...
'CreateFcn', {@local_CreateFcn, blanks(0), appdata} ,...
'DeleteFcn',blanks(0),...
'Tag','text46',...
'FontSize',0.672745694022291);

appdata = [];
appdata.lastValidTag = 'text44';

h15 = uicontrol(...
'Parent',h7,...
'Units','normalized',...
'FontUnits','normalized',...
'HorizontalAlignment','left',...
'String','Fit depth',...
'Style','text',...
'Position',[0.114285714285714 0.844984802431611 0.583673469387755 0.0668693009118541],...
'Children',[],...
'ButtonDownFcn',blanks(0),...
'CreateFcn', {@local_CreateFcn, blanks(0), appdata} ,...
'DeleteFcn',blanks(0),...
'Tag','text44',...
'FontSize',0.7);

appdata = [];
appdata.lastValidTag = 'uipanel10';

h16 = uipanel(...
'Parent',h1,...
'FontUnits','normalized',...
'Units',get(0,'defaultuipanelUnits'),...
'Title','Fit results',...
'CreateFcn', {@local_CreateFcn, blanks(0), appdata} ,...
'Tag','uipanel10',...
'Position',[0.471523178807947 0.0118203309692671 0.156953642384106 0.280141843971631],...
'FontSize',0.0562587904360056);

appdata = [];
appdata.lastValidTag = 'text12';

h17 = uicontrol(...
'Parent',h16,...
'Units','normalized',...
'FontUnits','normalized',...
'HorizontalAlignment','left',...
'String','Young''s Modulus soft:',...
'Style','text',...
'Position',[0.11587982832618 0.878378378378378 0.583690987124464 0.0945945945945946],...
'Children',[],...
'CreateFcn', {@local_CreateFcn, blanks(0), appdata} ,...
'Tag','text12',...
'FontSize',0.606060606060606);

appdata = [];
appdata.lastValidTag = 'result_Es';

h18 = uicontrol(...
'Parent',h16,...
'Units','normalized',...
'FontUnits','normalized',...
'String','none',...
'Style','text',...
'Position',[0.120171673819742 0.77027027027027 0.244635193133047 0.0945945945945946],...
'BackgroundColor',[1 1 1],...
'Children',[],...
'Enable','inactive',...
'CreateFcn', {@local_CreateFcn, blanks(0), appdata} ,...
'Tag','result_Es',...
'FontSize',0.606060606060606);

appdata = [];
appdata.lastValidTag = 'text14';

h19 = uicontrol(...
'Parent',h16,...
'Units','normalized',...
'FontUnits','normalized',...
'HorizontalAlignment','left',...
'String','kPa',...
'Style','text',...
'Position',[0.394849785407725 0.774774774774775 0.244635193133047 0.0855855855855856],...
'Children',[],...
'CreateFcn', {@local_CreateFcn, blanks(0), appdata} ,...
'Tag','text14',...
'FontSize',0.672745694022291);

appdata = [];
appdata.lastValidTag = 'text15';

h20 = uicontrol(...
'Parent',h16,...
'Units','normalized',...
'FontUnits','normalized',...
'HorizontalAlignment','left',...
'String','Young''s Modulus hard:',...
'Style','text',...
'Position',[0.11587982832618 0.635135135135135 0.592274678111588 0.0945945945945946],...
'Children',[],...
'ButtonDownFcn',blanks(0),...
'CreateFcn', {@local_CreateFcn, blanks(0), appdata} ,...
'DeleteFcn',blanks(0),...
'Tag','text15',...
'FontSize',0.611586994565717);

appdata = [];
appdata.lastValidTag = 'result_Eh';

h21 = uicontrol(...
'Parent',h16,...
'Units','normalized',...
'FontUnits','normalized',...
'String','none',...
'Style','text',...
'Position',[0.120171673819742 0.531531531531532 0.244635193133047 0.0945945945945946],...
'BackgroundColor',[1 1 1],...
'Children',[],...
'Enable','inactive',...
'ButtonDownFcn',blanks(0),...
'CreateFcn', {@local_CreateFcn, blanks(0), appdata} ,...
'DeleteFcn',blanks(0),...
'Tag','result_Eh',...
'FontSize',0.611586994565717);

appdata = [];
appdata.lastValidTag = 'text17';

h22 = uicontrol(...
'Parent',h16,...
'Units','normalized',...
'FontUnits','normalized',...
'HorizontalAlignment','left',...
'String','kPa',...
'Style','text',...
'Position',[0.394849785407725 0.540540540540541 0.244635193133047 0.0855855855855856],...
'Children',[],...
'ButtonDownFcn',blanks(0),...
'CreateFcn', {@local_CreateFcn, blanks(0), appdata} ,...
'DeleteFcn',blanks(0),...
'Tag','text17',...
'FontSize',0.67274569402229);

appdata = [];
appdata.lastValidTag = 'text18';

h23 = uicontrol(...
'Parent',h16,...
'Units','normalized',...
'FontUnits','normalized',...
'HorizontalAlignment','left',...
'String','Soft layer thickness',...
'Style','text',...
'Position',[0.11587982832618 0.396396396396396 0.545064377682403 0.0945945945945946],...
'Children',[],...
'ButtonDownFcn',blanks(0),...
'CreateFcn', {@local_CreateFcn, blanks(0), appdata} ,...
'DeleteFcn',blanks(0),...
'Tag','text18',...
'FontSize',0.611586994565718);

appdata = [];
appdata.lastValidTag = 'result_dh';

h24 = uicontrol(...
'Parent',h16,...
'Units','normalized',...
'FontUnits','normalized',...
'String','none',...
'Style','text',...
'Position',[0.120171673819742 0.292792792792793 0.244635193133047 0.0945945945945946],...
'BackgroundColor',[1 1 1],...
'Children',[],...
'Enable','inactive',...
'ButtonDownFcn',blanks(0),...
'CreateFcn', {@local_CreateFcn, blanks(0), appdata} ,...
'DeleteFcn',blanks(0),...
'Tag','result_dh',...
'FontSize',0.611586994565718);

appdata = [];
appdata.lastValidTag = 'text20';

h25 = uicontrol(...
'Parent',h16,...
'Units','normalized',...
'FontUnits','normalized',...
'HorizontalAlignment','left',...
'String',' µm',...
'Style','text',...
'Position',[0.394849785407725 0.306306306306306 0.244635193133047 0.0855855855855856],...
'Children',[],...
'ButtonDownFcn',blanks(0),...
'CreateFcn', {@local_CreateFcn, blanks(0), appdata} ,...
'DeleteFcn',blanks(0),...
'Tag','text20',...
'FontSize',0.672745694022289);

appdata = [];
appdata.lastValidTag = 'text30';

h26 = uicontrol(...
'Parent',h16,...
'Units','normalized',...
'FontUnits','normalized',...
'HorizontalAlignment','left',...
'String','Goodness of Fit',...
'Style','text',...
'Position',[0.11587982832618 0.144144144144144 0.545064377682403 0.0945945945945946],...
'Children',[],...
'ButtonDownFcn',blanks(0),...
'CreateFcn', {@local_CreateFcn, blanks(0), appdata} ,...
'DeleteFcn',blanks(0),...
'Tag','text30',...
'FontSize',0.611586994565717);

appdata = [];
appdata.lastValidTag = 'result_rsquare';

h27 = uicontrol(...
'Parent',h16,...
'Units','normalized',...
'FontUnits','normalized',...
'String','none',...
'Style','text',...
'Position',[0.120171673819742 0.045045045045045 0.244635193133047 0.0945945945945946],...
'BackgroundColor',[1 1 1],...
'Children',[],...
'Enable','inactive',...
'ButtonDownFcn',blanks(0),...
'CreateFcn', {@local_CreateFcn, blanks(0), appdata} ,...
'DeleteFcn',blanks(0),...
'Tag','result_rsquare',...
'FontSize',0.611586994565717);

appdata = [];
appdata.lastValidTag = 'uipanel20';

h28 = uipanel(...
'Parent',h1,...
'FontUnits','normalized',...
'Units',get(0,'defaultuipanelUnits'),...
'Title','Image Channel',...
'Visible',get(0,'defaultuipanelVisible'),...
'ResizeFcn',blanks(0),...
'ButtonDownFcn',blanks(0),...
'CreateFcn', {@local_CreateFcn, blanks(0), appdata} ,...
'DeleteFcn',blanks(0),...
'Tag','uipanel20',...
'Position',[0.0609271523178808 0.434988179669031 0.147682119205298 0.0626477541371158],...
'FontSize',0.242424242424242);

appdata = [];
appdata.lastValidTag = 'image_channels_popup';

h29 = uicontrol(...
'Parent',h28,...
'Units','normalized',...
'FontUnits','normalized',...
'String','no loaded channels',...
'Style','popupmenu',...
'Value',1,...
'ValueMode',get(0,'defaultuicontrolValueMode'),...
'Position',[0.0475091981941297 0.0988203883302278 0.924269855776705 0.716447815394151],...
'BackgroundColor',[1 1 1],...
'Callback',@(hObject,eventdata)bihertz_gui_export('image_channels_popup_Callback',hObject,eventdata,guidata(hObject)),...
'Children',[],...
'Enable','inactive',...
'ButtonDownFcn',blanks(0),...
'CreateFcn', {@local_CreateFcn, @(hObject,eventdata)bihertz_gui_export('image_channels_popup_CreateFcn',hObject,eventdata,guidata(hObject)), appdata} ,...
'DeleteFcn',blanks(0),...
'Tag','image_channels_popup',...
'KeyPressFcn',blanks(0),...
'FontSize',0.459770114942529);

appdata = [];
appdata.lastValidTag = 'listbox1';

h30 = uicontrol(...
'Parent',h1,...
'Units','normalized',...
'FontUnits','normalized',...
'String','No curves loaded',...
'Style','listbox',...
'Value',1,...
'ValueMode',get(0,'defaultuicontrolValueMode'),...
'Position',[0.408690176322418 0.545248868778281 0.535894206549118 0.397058823529412],...
'BackgroundColor',[1 1 1],...
'Callback',@(hObject,eventdata)bihertz_gui_export('listbox1_Callback',hObject,eventdata,guidata(hObject)),...
'Children',[],...
'ButtonDownFcn',@(hObject,eventdata)bihertz_gui_export('listbox1_ButtonDownFcn',hObject,eventdata,guidata(hObject)),...
'CreateFcn', {@local_CreateFcn, @(hObject,eventdata)bihertz_gui_export('listbox1_CreateFcn',hObject,eventdata,guidata(hObject)), appdata} ,...
'Tag','listbox1',...
'FontSize',0.0431266846361186);

appdata = [];
appdata.lastValidTag = 'uipanel1';

h31 = uipanel(...
'Parent',h1,...
'FontUnits','normalized',...
'Units',get(0,'defaultuipanelUnits'),...
'Title',blanks(0),...
'BackgroundColor',[1 1 1],...
'Tag','uipanel1',...
'Position',[0.109571788413098 0.884615384615385 0.19080604534005 0.0576923076923077],...
'FontSize',0.209150326797386,...
'FontSizeMode',get(0,'defaultuipanelFontSizeMode'),...
'CreateFcn', {@local_CreateFcn, blanks(0), appdata} );

appdata = [];
appdata.lastValidTag = 'text4';

h32 = uicontrol(...
'Parent',h31,...
'Units','normalized',...
'FontUnits','normalized',...
'String','Force-curve Processing',...
'Style','text',...
'Position',[0.096989966555184 0.148936170212766 0.782608695652174 0.595744680851064],...
'BackgroundColor',[1 1 1],...
'Children',[],...
'Tag','text4',...
'FontSize',0.571428571428571,...
'CreateFcn', {@local_CreateFcn, blanks(0), appdata} );

appdata = [];
appdata.lastValidTag = 'uipanel2';

h33 = uipanel(...
'Parent',h1,...
'FontUnits','normalized',...
'Units',get(0,'defaultuipanelUnits'),...
'Title','Load file',...
'CreateFcn', {@local_CreateFcn, blanks(0), appdata} ,...
'Tag','uipanel2',...
'Position',[0.0308564231738035 0.733031674208145 0.34823677581864 0.1289592760181],...
'FontSize',0.122212544758271);

appdata = [];
appdata.lastValidTag = 'edit_filepath';

h34 = uicontrol(...
'Parent',h33,...
'Units','normalized',...
'FontUnits','normalized',...
'HorizontalAlignment','left',...
'String','    filepath',...
'Style','edit',...
'Position',[0.0218579234972678 0.545454545454546 0.808743169398907 0.313131313131313],...
'BackgroundColor',[1 1 1],...
'Callback',@(hObject,eventdata)bihertz_gui_export('edit_filepath_Callback',hObject,eventdata,guidata(hObject)),...
'Children',[],...
'Enable','off',...
'CreateFcn', {@local_CreateFcn, @(hObject,eventdata)bihertz_gui_export('edit_filepath_CreateFcn',hObject,eventdata,guidata(hObject)), appdata} ,...
'Tag','edit_filepath',...
'FontSize',0.43010752688172);

appdata = [];
appdata.lastValidTag = 'button_file';

h35 = uicontrol(...
'Parent',h33,...
'Units','normalized',...
'FontUnits','normalized',...
'String','select file',...
'Style',get(0,'defaultuicontrolStyle'),...
'Position',[0.846994535519126 0.545454545454546 0.140255009107468 0.313131313131313],...
'Callback',@(hObject,eventdata)bihertz_gui_export('button_file_Callback',hObject,eventdata,guidata(hObject)),...
'Children',[],...
'CreateFcn', {@local_CreateFcn, blanks(0), appdata} ,...
'Tag','button_file',...
'FontSize',0.430107526881721);

appdata = [];
appdata.lastValidTag = 'button_load_data';

h36 = uicontrol(...
'Parent',h33,...
'Units','normalized',...
'FontUnits','normalized',...
'String','load data',...
'Style',get(0,'defaultuicontrolStyle'),...
'Position',[0.0218579234972678 0.151515151515152 0.182149362477231 0.292929292929293],...
'Callback',@(hObject,eventdata)bihertz_gui_export('button_load_data_Callback',hObject,eventdata,guidata(hObject)),...
'Children',[],...
'Tag','button_load_data',...
'FontSize',0.459770114942529,...
'CreateFcn', {@local_CreateFcn, blanks(0), appdata} );

appdata = [];
appdata.lastValidTag = 'button_folder';

h37 = uicontrol(...
'Parent',h33,...
'Units','normalized',...
'FontUnits','normalized',...
'String','select folder',...
'Style',get(0,'defaultuicontrolStyle'),...
'Position',[0.846994535519126 0.151515151515152 0.140255009107468 0.313131313131313],...
'Callback',@(hObject,eventdata)bihertz_gui_export('button_folder_Callback',hObject,eventdata,guidata(hObject)),...
'Children',[],...
'ButtonDownFcn',blanks(0),...
'CreateFcn', {@local_CreateFcn, blanks(0), appdata} ,...
'DeleteFcn',blanks(0),...
'Tag','button_folder',...
'KeyPressFcn',blanks(0),...
'FontSize',0.430107526881721);

appdata = [];
appdata.lastValidTag = 'uipanel4';

h38 = uipanel(...
'Parent',h1,...
'FontUnits','normalized',...
'Units',get(0,'defaultuipanelUnits'),...
'Title','Save results',...
'ResizeFcn',blanks(0),...
'ButtonDownFcn',blanks(0),...
'CreateFcn', {@local_CreateFcn, blanks(0), appdata} ,...
'DeleteFcn',blanks(0),...
'Tag','uipanel4',...
'Position',[0.0308564231738035 0.565610859728507 0.34823677581864 0.1289592760181],...
'FontSize',0.122212544758271);

appdata = [];
appdata.lastValidTag = 'edit_savepath';

h39 = uicontrol(...
'Parent',h38,...
'Units','normalized',...
'FontUnits','normalized',...
'HorizontalAlignment','left',...
'String','     savepath',...
'Style','edit',...
'Position',[0.0218579234972678 0.535353535353535 0.808743169398907 0.313131313131313],...
'BackgroundColor',[1 1 1],...
'Callback',@(hObject,eventdata)bihertz_gui_export('edit_savepath_Callback',hObject,eventdata,guidata(hObject)),...
'Children',[],...
'Enable','off',...
'ButtonDownFcn',blanks(0),...
'CreateFcn', {@local_CreateFcn, @(hObject,eventdata)bihertz_gui_export('edit_savepath_CreateFcn',hObject,eventdata,guidata(hObject)), appdata} ,...
'DeleteFcn',blanks(0),...
'Tag','edit_savepath',...
'KeyPressFcn',blanks(0),...
'FontSize',0.43010752688172);

appdata = [];
appdata.lastValidTag = 'button_save_path';

h40 = uicontrol(...
'Parent',h38,...
'Units','normalized',...
'FontUnits','normalized',...
'String','save path',...
'Style',get(0,'defaultuicontrolStyle'),...
'Position',[0.846994535519126 0.535353535353535 0.12568306010929 0.313131313131313],...
'Callback',@(hObject,eventdata)bihertz_gui_export('button_save_path_Callback',hObject,eventdata,guidata(hObject)),...
'Children',[],...
'ButtonDownFcn',blanks(0),...
'CreateFcn', {@local_CreateFcn, blanks(0), appdata} ,...
'DeleteFcn',blanks(0),...
'Tag','button_save_path',...
'KeyPressFcn',blanks(0),...
'FontSize',0.43010752688172);

appdata = [];
appdata.lastValidTag = 'save_status_text';

h41 = uicontrol(...
'Parent',h38,...
'Units','normalized',...
'FontUnits','normalized',...
'HorizontalAlignment','left',...
'String','Save status: ',...
'Style','text',...
'Position',[0.034608378870674 0.191919191919192 0.420765027322404 0.181818181818182],...
'Children',[],...
'Tag','save_status_text',...
'FontSize',0.740740740740741,...
'CreateFcn', {@local_CreateFcn, blanks(0), appdata} );

appdata = [];
appdata.lastValidTag = 'save_status_led';

h42 = uicontrol(...
'Parent',h38,...
'Units','points',...
'FontUnits','normalized',...
'String',blanks(0),...
'Style','edit',...
'Position',[72.5006024096386 13.078125 14 14],...
'BackgroundColor',[1 0 0],...
'Callback',@(hObject,eventdata)bihertz_gui_export('save_status_led_Callback',hObject,eventdata,guidata(hObject)),...
'Children',[],...
'ForegroundColor',[1 0 0],...
'Enable','inactive',...
'CreateFcn', {@local_CreateFcn, @(hObject,eventdata)bihertz_gui_export('save_status_led_CreateFcn',hObject,eventdata,guidata(hObject)), appdata} ,...
'Tag','save_status_led',...
'FontSize',0.00833333333333333);

appdata = [];
appdata.lastValidTag = 'button_keep_highlighted';

h43 = uicontrol(...
'Parent',h1,...
'Units','normalized',...
'FontUnits','normalized',...
'HorizontalAlignment',get(0,'defaultuicontrolHorizontalAlignment'),...
'String','<html><center>keep till<br>highlighted</center>',...
'Style',get(0,'defaultuicontrolStyle'),...
'Position',[0.462846347607053 0.455882352941177 0.0812342569269522 0.0565610859728507],...
'Callback',@(hObject,eventdata)bihertz_gui_export('button_keep_highlighted_Callback',hObject,eventdata,guidata(hObject)),...
'Children',[],...
'Enable','off',...
'Visible',get(0,'defaultuicontrolVisible'),...
'CreateFcn', {@local_CreateFcn, blanks(0), appdata} ,...
'Tag','button_keep_highlighted',...
'FontSize',0.266666666666667);

appdata = [];
appdata.lastValidTag = 'button_undo_highlighted';

h44 = uicontrol(...
'Parent',h1,...
'Units','normalized',...
'FontUnits','normalized',...
'HorizontalAlignment',get(0,'defaultuicontrolHorizontalAlignment'),...
'String','<html><center>undo till<br>highlighted</center>',...
'Style',get(0,'defaultuicontrolStyle'),...
'Position',[0.636020151133501 0.455882352941177 0.0812342569269522 0.0565610859728507],...
'Callback',@(hObject,eventdata)bihertz_gui_export('button_undo_highlighted_Callback',hObject,eventdata,guidata(hObject)),...
'Children',[],...
'Enable','off',...
'Visible',get(0,'defaultuicontrolVisible'),...
'ButtonDownFcn',blanks(0),...
'CreateFcn', {@local_CreateFcn, blanks(0), appdata} ,...
'DeleteFcn',blanks(0),...
'Tag','button_undo_highlighted',...
'KeyPressFcn',blanks(0),...
'FontSize',0.266666666666667);

appdata = [];
appdata.lastValidTag = 'map_axes_context';

h45 = uicontextmenu(...
'Parent',h1,...
'Visible',get(0,'defaultuicontextmenuVisible'),...
'Callback',@(hObject,eventdata)bihertz_gui_export('map_axes_context_Callback',hObject,eventdata,guidata(hObject)),...
'Tag','map_axes_context',...
'CreateFcn', {@local_CreateFcn, blanks(0), appdata} );

appdata = [];
appdata.lastValidTag = 'interpolation_type';

h46 = uimenu(...
'Parent',h45,...
'Callback',@(hObject,eventdata)bihertz_gui_export('interpolation_type_Callback',hObject,eventdata,guidata(hObject)),...
'Label','Interpolation',...
'Tag','interpolation_type',...
'CreateFcn', {@local_CreateFcn, blanks(0), appdata} );

appdata = [];
appdata.lastValidTag = 'none';

h47 = uimenu(...
'Parent',h46,...
'Callback',@(hObject,eventdata)bihertz_gui_export('none_Callback',hObject,eventdata,guidata(hObject)),...
'Label','none',...
'Tag','none',...
'CreateFcn', {@local_CreateFcn, blanks(0), appdata} );

appdata = [];
appdata.lastValidTag = 'linear';

h48 = uimenu(...
'Parent',h46,...
'Callback',@(hObject,eventdata)bihertz_gui_export('linear_Callback',hObject,eventdata,guidata(hObject)),...
'Label','linear',...
'Tag','linear',...
'CreateFcn', {@local_CreateFcn, blanks(0), appdata} );

appdata = [];
appdata.lastValidTag = 'bicubic';

h49 = uimenu(...
'Parent',h46,...
'Callback',@(hObject,eventdata)bihertz_gui_export('bicubic_Callback',hObject,eventdata,guidata(hObject)),...
'Checked','on',...
'Label','bicubic',...
'Tag','bicubic',...
'CreateFcn', {@local_CreateFcn, blanks(0), appdata} );

appdata = [];
appdata.lastValidTag = 'button_discard_highlighted';

h50 = uicontrol(...
'Parent',h1,...
'Units','normalized',...
'FontUnits','normalized',...
'HorizontalAlignment',get(0,'defaultuicontrolHorizontalAlignment'),...
'String','<html><center>discard till<br>highlighted</center>',...
'Style',get(0,'defaultuicontrolStyle'),...
'Position',[0.808564231738035 0.455882352941177 0.0812342569269522 0.0565610859728507],...
'Callback',@(hObject,eventdata)bihertz_gui_export('button_discard_highlighted_Callback',hObject,eventdata,guidata(hObject)),...
'Children',[],...
'Enable','off',...
'Visible',get(0,'defaultuicontrolVisible'),...
'ButtonDownFcn',blanks(0),...
'CreateFcn', {@local_CreateFcn, blanks(0), appdata} ,...
'DeleteFcn',blanks(0),...
'Tag','button_discard_highlighted',...
'KeyPressFcn',blanks(0),...
'FontSize',0.266666666666667);

appdata = [];
appdata.lastValidTag = 'uipanel9';

h51 = uipanel(...
'Parent',h1,...
'FontUnits','normalized',...
'Units',get(0,'defaultuipanelUnits'),...
'Title','Controls',...
'Tag','uipanel9',...
'Position',[0.698362720403023 0.108597285067873 0.199622166246851 0.263574660633484],...
'FontSize',0.0572246065808298,...
'CreateFcn', {@local_CreateFcn, blanks(0), appdata} );

appdata = [];
appdata.lastValidTag = 'button_keep';

h52 = uicontrol(...
'Parent',h51,...
'Units','normalized',...
'FontUnits','normalized',...
'String','Keep',...
'Style',get(0,'defaultuicontrolStyle'),...
'Position',[0.0958466453674121 0.591743119266055 0.329073482428115 0.279816513761468],...
'BackgroundColor',[0 1 0],...
'Callback',@(hObject,eventdata)bihertz_gui_export('button_keep_Callback',hObject,eventdata,guidata(hObject)),...
'Children',[],...
'Enable','off',...
'BusyAction','cancel',...
'Interruptible','off',...
'CreateFcn', {@local_CreateFcn, blanks(0), appdata} ,...
'Tag','button_keep',...
'KeyPressFcn',@(hObject,eventdata)bihertz_gui_export('button_keep_KeyPressFcn',hObject,eventdata,guidata(hObject)),...
'FontSize',0.218579234972678);

appdata = [];
appdata.lastValidTag = 'button_discard';

h53 = uicontrol(...
'Parent',h51,...
'Units','normalized',...
'FontUnits','normalized',...
'String','Discard',...
'Style',get(0,'defaultuicontrolStyle'),...
'Position',[0.587859424920128 0.591743119266055 0.329073482428115 0.279816513761468],...
'BackgroundColor',[1 0 0],...
'Callback',@(hObject,eventdata)bihertz_gui_export('button_discard_Callback',hObject,eventdata,guidata(hObject)),...
'Children',[],...
'Enable','off',...
'ButtonDownFcn',blanks(0),...
'BusyAction','cancel',...
'Interruptible','off',...
'CreateFcn', {@local_CreateFcn, blanks(0), appdata} ,...
'DeleteFcn',blanks(0),...
'Tag','button_discard',...
'KeyPressFcn',blanks(0),...
'FontSize',0.218579234972678);

appdata = [];
appdata.lastValidTag = 'button_undo';

h54 = uicontrol(...
'Parent',h51,...
'Units','normalized',...
'FontUnits','normalized',...
'String','Undo',...
'Style',get(0,'defaultuicontrolStyle'),...
'Position',[0.0958466453674121 0.128440366972477 0.329073482428115 0.279816513761468],...
'BackgroundColor',[0.650980392156863 0.650980392156863 0.650980392156863],...
'Callback',@(hObject,eventdata)bihertz_gui_export('button_undo_Callback',hObject,eventdata,guidata(hObject)),...
'Children',[],...
'Enable','off',...
'ButtonDownFcn',blanks(0),...
'BusyAction','cancel',...
'Interruptible','off',...
'CreateFcn', {@local_CreateFcn, blanks(0), appdata} ,...
'DeleteFcn',blanks(0),...
'Tag','button_undo',...
'KeyPressFcn',blanks(0),...
'FontSize',0.218579234972678);

appdata = [];
appdata.lastValidTag = 'button_keep_all';

h55 = uicontrol(...
'Parent',h51,...
'Units','normalized',...
'FontUnits','normalized',...
'String','<html><center>Keep & Apply<br>to all</center>',...
'Style',get(0,'defaultuicontrolStyle'),...
'Position',[0.587859424920128 0.128440366972477 0.329073482428115 0.279816513761468],...
'BackgroundColor',[0.929411764705882 0.690196078431373 0.129411764705882],...
'Callback',@(hObject,eventdata)bihertz_gui_export('button_keep_all_Callback',hObject,eventdata,guidata(hObject)),...
'Children',[],...
'Enable','off',...
'ButtonDownFcn',blanks(0),...
'CreateFcn', {@local_CreateFcn, blanks(0), appdata} ,...
'DeleteFcn',blanks(0),...
'Tag','button_keep_all',...
'KeyPressFcn',blanks(0),...
'FontSize',0.218579234972678);

appdata = [];
appdata.lastValidTag = 'uipanel11';

h56 = uipanel(...
'Parent',h1,...
'FontUnits',get(0,'defaultuipanelFontUnits'),...
'Units',get(0,'defaultuipanelUnits'),...
'Title','Processing infos',...
'Tag','uipanel11',...
'Position',[0.261954261954262 0.0107948969578018 0.146569646569647 0.432777232580962],...
'FontSize',10,...
'CreateFcn', {@local_CreateFcn, blanks(0), appdata} );

appdata = [];
appdata.lastValidTag = 'uipanel17';

h57 = uipanel(...
'Parent',h56,...
'FontUnits','normalized',...
'Units',get(0,'defaultuipanelUnits'),...
'Title','Progress',...
'ResizeFcn',blanks(0),...
'ButtonDownFcn',blanks(0),...
'CreateFcn', {@local_CreateFcn, blanks(0), appdata} ,...
'DeleteFcn',blanks(0),...
'Tag','uipanel17',...
'Position',[0.0797101449275362 0.0141176470588235 0.880434782608696 0.24],...
'FontSize',0.130718954248366);

appdata = [];
appdata.lastValidTag = 'text27';

h58 = uicontrol(...
'Parent',h57,...
'Units','normalized',...
'FontUnits','normalized',...
'HorizontalAlignment','left',...
'String','unprocessed:',...
'Style','text',...
'Position',[0.0609137055837563 0.632183908045977 0.893401015228426 0.264367816091954],...
'Children',[],...
'ButtonDownFcn',blanks(0),...
'CreateFcn', {@local_CreateFcn, blanks(0), appdata} ,...
'DeleteFcn',blanks(0),...
'Tag','text27',...
'FontSize',0.579710144927536);

appdata = [];
appdata.lastValidTag = 'text28';

h59 = uicontrol(...
'Parent',h57,...
'Units','normalized',...
'FontUnits','normalized',...
'HorizontalAlignment','left',...
'String','processed:',...
'Style','text',...
'Position',[0.0609137055837563 0.367816091954023 0.913705583756345 0.264367816091954],...
'Children',[],...
'ButtonDownFcn',blanks(0),...
'CreateFcn', {@local_CreateFcn, blanks(0), appdata} ,...
'DeleteFcn',blanks(0),...
'Tag','text28',...
'FontSize',0.579710144927536);

appdata = [];
appdata.lastValidTag = 'text29';

h60 = uicontrol(...
'Parent',h57,...
'Units','normalized',...
'FontUnits','normalized',...
'HorizontalAlignment','left',...
'String','discarted',...
'Style','text',...
'Position',[0.0609137055837563 0.103448275862069 0.913705583756345 0.264367816091954],...
'Children',[],...
'ButtonDownFcn',blanks(0),...
'CreateFcn', {@local_CreateFcn, blanks(0), appdata} ,...
'DeleteFcn',blanks(0),...
'Tag','text29',...
'FontSize',0.579710144927536);

appdata = [];
appdata.lastValidTag = 'uipanel12';

h61 = uipanel(...
'Parent',h56,...
'FontUnits','normalized',...
'Units',get(0,'defaultuipanelUnits'),...
'ForegroundColor',get(0,'defaultuipanelForegroundColor'),...
'HighlightColor',get(0,'defaultuipanelHighlightColor'),...
'ShadowColor',get(0,'defaultuipanelShadowColor'),...
'BorderType',get(0,'defaultuipanelBorderType'),...
'BorderWidth',get(0,'defaultuipanelBorderWidth'),...
'TitlePosition',get(0,'defaultuipanelTitlePosition'),...
'Title','Calibration values',...
'Visible',get(0,'defaultuipanelVisible'),...
'BackgroundColor',get(0,'defaultuipanelBackgroundColor'),...
'ResizeFcn',blanks(0),...
'HandleVisibility',get(0,'defaultuipanelHandleVisibility'),...
'ButtonDownFcn',blanks(0),...
'CreateFcn', {@local_CreateFcn, blanks(0), appdata} ,...
'DeleteFcn',blanks(0),...
'Tag','uipanel12',...
'UserData',[],...
'Position',[0.0763636363636364 0.727154517309316 0.88 0.241626794258373],...
'FontSize',0.128079135279532,...
'FontName',get(0,'defaultuipanelFontName'),...
'FontAngle',get(0,'defaultuipanelFontAngle'),...
'FontWeight',get(0,'defaultuipanelFontWeight'));

appdata = [];
appdata.lastValidTag = 'text_sensitivity';

h62 = uicontrol(...
'Parent',h61,...
'Units','normalized',...
'FontUnits','normalized',...
'HorizontalAlignment','left',...
'ListboxTop',get(0,'defaultuicontrolListboxTop'),...
'Max',get(0,'defaultuicontrolMax'),...
'Min',get(0,'defaultuicontrolMin'),...
'SliderStep',get(0,'defaultuicontrolSliderStep'),...
'String','Sensitivity:',...
'Style','text',...
'Value',get(0,'defaultuicontrolValue'),...
'Position',[0.0609137055837563 0.5625 0.893401015228426 0.2625],...
'BackgroundColor',get(0,'defaultuicontrolBackgroundColor'),...
'Callback',blanks(0),...
'Children',[],...
'ForegroundColor',get(0,'defaultuicontrolForegroundColor'),...
'Enable',get(0,'defaultuicontrolEnable'),...
'TooltipString',blanks(0),...
'Visible',get(0,'defaultuicontrolVisible'),...
'HandleVisibility',get(0,'defaultuicontrolHandleVisibility'),...
'ButtonDownFcn',blanks(0),...
'CreateFcn', {@local_CreateFcn, blanks(0), appdata} ,...
'DeleteFcn',blanks(0),...
'Tag','text_sensitivity',...
'UserData',[],...
'KeyPressFcn',blanks(0),...
'KeyReleaseFcn',blanks(0),...
'FontSize',0.615680615680616,...
'FontName',get(0,'defaultuicontrolFontName'),...
'FontAngle',get(0,'defaultuicontrolFontAngle'),...
'FontWeight',get(0,'defaultuicontrolFontWeight'));

appdata = [];
appdata.lastValidTag = 'text_spring_const';

h63 = uicontrol(...
'Parent',h61,...
'Units','normalized',...
'FontUnits','normalized',...
'HorizontalAlignment','left',...
'ListboxTop',get(0,'defaultuicontrolListboxTop'),...
'Max',get(0,'defaultuicontrolMax'),...
'Min',get(0,'defaultuicontrolMin'),...
'SliderStep',get(0,'defaultuicontrolSliderStep'),...
'String','Spring const.:',...
'Style','text',...
'Value',get(0,'defaultuicontrolValue'),...
'Position',[0.0609137055837563 0.2125 0.913705583756345 0.2625],...
'BackgroundColor',get(0,'defaultuicontrolBackgroundColor'),...
'Callback',blanks(0),...
'Children',[],...
'ForegroundColor',get(0,'defaultuicontrolForegroundColor'),...
'Enable',get(0,'defaultuicontrolEnable'),...
'TooltipString',blanks(0),...
'Visible',get(0,'defaultuicontrolVisible'),...
'HandleVisibility',get(0,'defaultuicontrolHandleVisibility'),...
'ButtonDownFcn',blanks(0),...
'CreateFcn', {@local_CreateFcn, blanks(0), appdata} ,...
'DeleteFcn',blanks(0),...
'Tag','text_spring_const',...
'UserData',[],...
'KeyPressFcn',blanks(0),...
'KeyReleaseFcn',blanks(0),...
'FontSize',0.615680615680616,...
'FontName',get(0,'defaultuicontrolFontName'),...
'FontAngle',get(0,'defaultuicontrolFontAngle'),...
'FontWeight',get(0,'defaultuicontrolFontWeight'));

appdata = [];
appdata.lastValidTag = 'baseline_btngroup';

h64 = uibuttongroup(...
'Parent',h56,...
'FontUnits','normalized',...
'Units','normalized',...
'SelectionChangeFcn',@(hObject,eventdata)bihertz_gui('baseline_btngroup_SelectionChangedFcn',get(hObject,'SelectedObject'),eventdata,guidata(get(hObject,'SelectedObject'))),...
'Title','Baseline correction mode',...
'CreateFcn', {@local_CreateFcn, @(hObject,eventdata)bihertz_gui('baseline_btngroup_CreateFcn',hObject,eventdata,guidata(hObject)), appdata} ,...
'Tag','baseline_btngroup',...
'Position',[0.072463768115942 0.461176470588235 0.884057971014493 0.265882352941177],...
'FontSize',0.124423304111188);

appdata = [];
appdata.lastValidTag = 'radiobutton4';

h65 = uicontrol(...
'Parent',h64,...
'Units','normalized',...
'FontUnits','normalized',...
'String','none',...
'Style','radiobutton',...
'Value',get(0,'defaultuicontrolValue'),...
'Position',[0.0585774058577406 0.689075630252101 0.489539748953975 0.243697478991597],...
'Children',[],...
'Tag','radiobutton4',...
'FontSize',0.605938697318008,...
'CreateFcn', {@local_CreateFcn, blanks(0), appdata} );

appdata = [];
appdata.lastValidTag = 'offset';

h66 = uicontrol(...
'Parent',h64,...
'Units','normalized',...
'FontUnits','normalized',...
'String','Offset',...
'Style','radiobutton',...
'Position',[0.0585774058577406 0.400196821152703 0.489539748953975 0.243697478991597],...
'Children',[],...
'Tag','offset',...
'FontSize',0.605938697318008,...
'CreateFcn', {@local_CreateFcn, blanks(0), appdata} );

appdata = [];
appdata.lastValidTag = 'offset_and_tilt';

h67 = uicontrol(...
'Parent',h64,...
'Units','normalized',...
'FontUnits','normalized',...
'String','Offset + Tilt',...
'Style','radiobutton',...
'Value',1,...
'Position',[0.0585774058577406 0.100585688820983 0.489539748953975 0.243697478991597],...
'Children',[],...
'Tag','offset_and_tilt',...
'FontSize',0.605938697318008,...
'CreateFcn', {@local_CreateFcn, blanks(0), appdata} );

appdata = [];
appdata.lastValidTag = 'btngroup_contact';

h68 = uibuttongroup(...
'Parent',h56,...
'FontUnits','normalized',...
'Units','normalized',...
'SelectionChangeFcn',@(hObject,eventdata)bihertz_gui('btngroup_contact_SelectionChangedFcn',get(hObject,'SelectedObject'),eventdata,guidata(get(hObject,'SelectedObject'))),...
'ForegroundColor',[0 0 0],...
'HighlightColor',[1 1 1],...
'ShadowColor',[0.7 0.7 0.7],...
'BorderType','etchedin',...
'BorderWidth',1,...
'TitlePosition','lefttop',...
'Title','Contact Point Finder',...
'Visible','on',...
'BackgroundColor',[0.94 0.94 0.94],...
'ResizeFcn',blanks(0),...
'HandleVisibility','on',...
'ButtonDownFcn',blanks(0),...
'CreateFcn', {@local_CreateFcn, blanks(0), appdata} ,...
'DeleteFcn',blanks(0),...
'Tag','btngroup_contact',...
'UserData',[],...
'Position',[0.072463768115942 0.265882352941176 0.88768115942029 0.192941176470588],...
'FontSize',0.155121951219512,...
'FontName','MS Sans Serif',...
'FontAngle','normal',...
'FontWeight','normal');

appdata = [];
appdata.lastValidTag = 'intersection';

h69 = uicontrol(...
'Parent',h68,...
'Units','normalized',...
'FontUnits','normalized',...
'String','via intersection',...
'Style','radiobutton',...
'Value',1,...
'Position',[0.0543933054393305 0.484848484848485 0.753138075313807 0.439393939393939],...
'Children',[],...
'Tag','intersection',...
'FontSize',0.501724137931035,...
'CreateFcn', {@local_CreateFcn, blanks(0), appdata} );

appdata = [];
appdata.lastValidTag = 'cp_hertzfit';

h70 = uicontrol(...
'Parent',h68,...
'Units','normalized',...
'FontUnits','normalized',...
'String','via Hertz fit',...
'Style','radiobutton',...
'Position',[0.0543933054393305 0.0606060606060606 0.489539748953975 0.439393939393939],...
'Children',[],...
'Tag','cp_hertzfit',...
'FontSize',0.501724137931035,...
'CreateFcn', {@local_CreateFcn, blanks(0), appdata} );

appdata = [];
appdata.lastValidTag = 'exit';

h71 = uimenu(...
'Parent',h1,...
'Callback',@(hObject,eventdata)bihertz_gui_export('exit_Callback',hObject,eventdata,guidata(hObject)),...
'Label','Exit',...
'Tag','exit',...
'CreateFcn', {@local_CreateFcn, blanks(0), appdata} );

appdata = [];
appdata.lastValidTag = 'uipanel13';

h72 = uipanel(...
'Parent',h1,...
'FontUnits','normalized',...
'Units',get(0,'defaultuipanelUnits'),...
'Title','Fit-model',...
'CreateFcn', {@local_CreateFcn, blanks(0), appdata} ,...
'Tag','uipanel13',...
'Position',[0.260705289672544 0.4583877099841 0.147984886649874 0.0622171945701358],...
'FontSize',0.242424242424242);

appdata = [];
appdata.lastValidTag = 'fit_model_popup';

h73 = uicontrol(...
'Parent',h72,...
'Units','normalized',...
'FontUnits','normalized',...
'String',{  'Bihetz_sum_heaviside'; 'Hertz-Fit' },...
'Style','popupmenu',...
'Value',1,...
'ValueMode',get(0,'defaultuicontrolValueMode'),...
'Position',[0.0476190476190476 0.1 0.926406926406926 0.725],...
'BackgroundColor',[1 1 1],...
'Callback',@(hObject,eventdata)bihertz_gui_export('fit_model_popup_Callback',hObject,eventdata,guidata(hObject)),...
'Children',[],...
'Enable','inactive',...
'CreateFcn', {@local_CreateFcn, @(hObject,eventdata)bihertz_gui_export('fit_model_popup_CreateFcn',hObject,eventdata,guidata(hObject)), appdata} ,...
'Tag','fit_model_popup',...
'FontSize',0.459770114942529);

appdata = [];
appdata.lastValidTag = 'uipanel5';

h74 = uipanel(...
'Parent',h1,...
'FontUnits','normalized',...
'Units',get(0,'defaultuipanelUnits'),...
'Title','Fit parameter',...
'Visible',get(0,'defaultuipanelVisible'),...
'BackgroundColor',get(0,'defaultuipanelBackgroundColor'),...
'Tag','uipanel5',...
'Position',[0.471523178807947 0.293144208037825 0.157615894039735 0.150118203309693],...
'FontSize',0.10498687664042,...
'CreateFcn', {@local_CreateFcn, blanks(0), appdata} );

appdata = [];
appdata.lastValidTag = 'uipanel6';

h75 = uipanel(...
'Parent',h74,...
'FontUnits','normalized',...
'Units',get(0,'defaultuipanelUnits'),...
'Title',blanks(0),...
'CreateFcn', {@local_CreateFcn, blanks(0), appdata} ,...
'Tag','uipanel6',...
'Position',[0.0897435897435898 0.508928571428571 0.786324786324786 0.428571428571429],...
'FontSize',0.117647058823529,...
'FontSizeMode',get(0,'defaultuipanelFontSizeMode'));

appdata = [];
appdata.lastValidTag = 'text7';

h76 = uicontrol(...
'Parent',h75,...
'Units','normalized',...
'FontUnits','normalized',...
'String','Fit depth of soft part',...
'Style','text',...
'Position',[0.0506072874493927 0.704092459514065 0.680386864597391 0.336733217592593],...
'Children',[],...
'Tag','text7',...
'FontSize',0.846560846560847,...
'CreateFcn', {@local_CreateFcn, blanks(0), appdata} );

appdata = [];
appdata.lastValidTag = 'fit_depth';

h77 = uicontrol(...
'Parent',h75,...
'Units','normalized',...
'FontUnits','normalized',...
'String','1',...
'Style','edit',...
'Position',[0.0506072874493927 0.141122262754806 0.286774628879892 0.529152199074074],...
'BackgroundColor',[1 1 1],...
'Callback',@(hObject,eventdata)bihertz_gui_export('fit_depth_Callback',hObject,eventdata,guidata(hObject)),...
'Children',[],...
'CreateFcn', {@local_CreateFcn, @(hObject,eventdata)bihertz_gui_export('fit_depth_CreateFcn',hObject,eventdata,guidata(hObject)), appdata} ,...
'Tag','fit_depth',...
'KeyPressFcn',@(hObject,eventdata)bihertz_gui_export('fit_depth_KeyPressFcn',hObject,eventdata,guidata(hObject)),...
'FontSize',0.538720538720539);

appdata = [];
appdata.lastValidTag = 'text8';

h78 = uicontrol(...
'Parent',h75,...
'Units','normalized',...
'FontUnits','normalized',...
'HorizontalAlignment','left',...
'String','µm',...
'Style','text',...
'Position',[0.376743139901035 0.189227008125176 0.292397660818713 0.432942708333333],...
'Children',[],...
'Tag','text8',...
'FontSize',0.65843621399177,...
'CreateFcn', {@local_CreateFcn, blanks(0), appdata} );

appdata = [];
appdata.lastValidTag = 'uipanel7';

h79 = uipanel(...
'Parent',h74,...
'FontUnits','normalized',...
'Units',get(0,'defaultuipanelUnits'),...
'Title',blanks(0),...
'ResizeFcn',blanks(0),...
'ButtonDownFcn',blanks(0),...
'CreateFcn', {@local_CreateFcn, blanks(0), appdata} ,...
'DeleteFcn',blanks(0),...
'Tag','uipanel7',...
'Position',[0.0897435897435897 0.0535714285714286 0.786324786324786 0.428571428571429],...
'FontSize',0.156540777230432,...
'FontSizeMode',get(0,'defaultuipanelFontSizeMode'));

appdata = [];
appdata.lastValidTag = 'text10';

h80 = uicontrol(...
'Parent',h79,...
'Units','normalized',...
'FontUnits','normalized',...
'HorizontalAlignment','left',...
'String','%',...
'Style','text',...
'Position',[0.374661686089427 0.120366229663591 0.290782204129107 0.438639322916667],...
'Children',[],...
'ButtonDownFcn',blanks(0),...
'CreateFcn', {@local_CreateFcn, blanks(0), appdata} ,...
'DeleteFcn',blanks(0),...
'Tag','text10',...
'FontSize',0.658436213991769);

appdata = [];
appdata.lastValidTag = 'fit_perc';

h81 = uicontrol(...
'Parent',h79,...
'Units','normalized',...
'FontUnits','normalized',...
'String','5',...
'Style','edit',...
'Position',[0.0503276891761916 0.0716285271172943 0.285190238665086 0.536114728009259],...
'BackgroundColor',[1 1 1],...
'Callback',@(hObject,eventdata)bihertz_gui_export('fit_perc_Callback',hObject,eventdata,guidata(hObject)),...
'Children',[],...
'ButtonDownFcn',blanks(0),...
'CreateFcn', {@local_CreateFcn, @(hObject,eventdata)bihertz_gui_export('fit_perc_CreateFcn',hObject,eventdata,guidata(hObject)), appdata} ,...
'DeleteFcn',blanks(0),...
'Tag','fit_perc',...
'KeyPressFcn',blanks(0),...
'FontSize',0.538720538720539);

appdata = [];
appdata.lastValidTag = 'text9';

h82 = uicontrol(...
'Parent',h79,...
'Units','normalized',...
'FontUnits','normalized',...
'String','Fit percentage of hard part',...
'Style','text',...
'Position',[0.0503276891761916 0.616526654806221 0.889122508779386 0.438639322916667],...
'Children',[],...
'ButtonDownFcn',blanks(0),...
'CreateFcn', {@local_CreateFcn, blanks(0), appdata} ,...
'DeleteFcn',blanks(0),...
'Tag','text9',...
'FontSize',0.65843621399177);

handles = [ h2 h46 ];
set(handles, 'uicontextmenu', h45);


hsingleton = h1;


% --- Set application data first then calling the CreateFcn. 
function local_CreateFcn(hObject, eventdata, createfcn, appdata)

if ~isempty(appdata)
   names = fieldnames(appdata);
   for i=1:length(names)
       name = char(names(i));
       setappdata(hObject, name, getfield(appdata,name));
   end
end

if ~isempty(createfcn)
   if isa(createfcn,'function_handle')
       createfcn(hObject, eventdata);
   else
       eval(createfcn);
   end
end


% --- Handles default GUIDE GUI creation and callback dispatch
function varargout = gui_mainfcn(gui_State, varargin)

gui_StateFields =  {'gui_Name'
    'gui_Singleton'
    'gui_OpeningFcn'
    'gui_OutputFcn'
    'gui_LayoutFcn'
    'gui_Callback'};
gui_Mfile = '';
for i=1:length(gui_StateFields)
    if ~isfield(gui_State, gui_StateFields{i})
        error(message('MATLAB:guide:StateFieldNotFound', gui_StateFields{ i }, gui_Mfile));
    elseif isequal(gui_StateFields{i}, 'gui_Name')
        gui_Mfile = [gui_State.(gui_StateFields{i}), '.m'];
    end
end

numargin = length(varargin);

if numargin == 0
    % BIHERTZ_GUI_EXPORT
    % create the GUI only if we are not in the process of loading it
    % already
    gui_Create = true;
elseif local_isInvokeActiveXCallback(gui_State, varargin{:})
    % BIHERTZ_GUI_EXPORT(ACTIVEX,...)
    vin{1} = gui_State.gui_Name;
    vin{2} = [get(varargin{1}.Peer, 'Tag'), '_', varargin{end}];
    vin{3} = varargin{1};
    vin{4} = varargin{end-1};
    vin{5} = guidata(varargin{1}.Peer);
    feval(vin{:});
    return;
elseif local_isInvokeHGCallback(gui_State, varargin{:})
    % BIHERTZ_GUI_EXPORT('CALLBACK',hObject,eventData,handles,...)
    gui_Create = false;
else
    % BIHERTZ_GUI_EXPORT(...)
    % create the GUI and hand varargin to the openingfcn
    gui_Create = true;
end

if ~gui_Create
    % In design time, we need to mark all components possibly created in
    % the coming callback evaluation as non-serializable. This way, they
    % will not be brought into GUIDE and not be saved in the figure file
    % when running/saving the GUI from GUIDE.
    designEval = false;
    if (numargin>1 && ishghandle(varargin{2}))
        fig = varargin{2};
        while ~isempty(fig) && ~ishghandle(fig,'figure')
            fig = get(fig,'parent');
        end
        
        designEval = isappdata(0,'CreatingGUIDEFigure') || (isscalar(fig)&&isprop(fig,'GUIDEFigure'));
    end
        
    if designEval
        beforeChildren = findall(fig);
    end
    
    % evaluate the callback now
    varargin{1} = gui_State.gui_Callback;
    if nargout
        [varargout{1:nargout}] = feval(varargin{:});
    else       
        feval(varargin{:});
    end
    
    % Set serializable of objects created in the above callback to off in
    % design time. Need to check whether figure handle is still valid in
    % case the figure is deleted during the callback dispatching.
    if designEval && ishghandle(fig)
        set(setdiff(findall(fig),beforeChildren), 'Serializable','off');
    end
else
    if gui_State.gui_Singleton
        gui_SingletonOpt = 'reuse';
    else
        gui_SingletonOpt = 'new';
    end

    % Check user passing 'visible' P/V pair first so that its value can be
    % used by oepnfig to prevent flickering
    gui_Visible = 'auto';
    gui_VisibleInput = '';
    for index=1:2:length(varargin)
        if length(varargin) == index || ~ischar(varargin{index})
            break;
        end

        % Recognize 'visible' P/V pair
        len1 = min(length('visible'),length(varargin{index}));
        len2 = min(length('off'),length(varargin{index+1}));
        if ischar(varargin{index+1}) && strncmpi(varargin{index},'visible',len1) && len2 > 1
            if strncmpi(varargin{index+1},'off',len2)
                gui_Visible = 'invisible';
                gui_VisibleInput = 'off';
            elseif strncmpi(varargin{index+1},'on',len2)
                gui_Visible = 'visible';
                gui_VisibleInput = 'on';
            end
        end
    end
    
    % Open fig file with stored settings.  Note: This executes all component
    % specific CreateFunctions with an empty HANDLES structure.

    
    % Do feval on layout code in m-file if it exists
    gui_Exported = ~isempty(gui_State.gui_LayoutFcn);
    % this application data is used to indicate the running mode of a GUIDE
    % GUI to distinguish it from the design mode of the GUI in GUIDE. it is
    % only used by actxproxy at this time.   
    setappdata(0,genvarname(['OpenGuiWhenRunning_', gui_State.gui_Name]),1);
    if gui_Exported
        gui_hFigure = feval(gui_State.gui_LayoutFcn, gui_SingletonOpt);

        % make figure invisible here so that the visibility of figure is
        % consistent in OpeningFcn in the exported GUI case
        if isempty(gui_VisibleInput)
            gui_VisibleInput = get(gui_hFigure,'Visible');
        end
        set(gui_hFigure,'Visible','off')

        % openfig (called by local_openfig below) does this for guis without
        % the LayoutFcn. Be sure to do it here so guis show up on screen.
        movegui(gui_hFigure,'onscreen');
    else
        gui_hFigure = local_openfig(gui_State.gui_Name, gui_SingletonOpt, gui_Visible);
        % If the figure has InGUIInitialization it was not completely created
        % on the last pass.  Delete this handle and try again.
        if isappdata(gui_hFigure, 'InGUIInitialization')
            delete(gui_hFigure);
            gui_hFigure = local_openfig(gui_State.gui_Name, gui_SingletonOpt, gui_Visible);
        end
    end
    if isappdata(0, genvarname(['OpenGuiWhenRunning_', gui_State.gui_Name]))
        rmappdata(0,genvarname(['OpenGuiWhenRunning_', gui_State.gui_Name]));
    end

    % Set flag to indicate starting GUI initialization
    setappdata(gui_hFigure,'InGUIInitialization',1);

    % Fetch GUIDE Application options
    gui_Options = getappdata(gui_hFigure,'GUIDEOptions');
    % Singleton setting in the GUI MATLAB code file takes priority if different
    gui_Options.singleton = gui_State.gui_Singleton;

    if ~isappdata(gui_hFigure,'GUIOnScreen')
        % Adjust background color
        if gui_Options.syscolorfig
            set(gui_hFigure,'Color', get(0,'DefaultUicontrolBackgroundColor'));
        end

        % Generate HANDLES structure and store with GUIDATA. If there is
        % user set GUI data already, keep that also.
        data = guidata(gui_hFigure);
        handles = guihandles(gui_hFigure);
        if ~isempty(handles)
            if isempty(data)
                data = handles;
            else
                names = fieldnames(handles);
                for k=1:length(names)
                    data.(char(names(k)))=handles.(char(names(k)));
                end
            end
        end
        guidata(gui_hFigure, data);
    end

    % Apply input P/V pairs other than 'visible'
    for index=1:2:length(varargin)
        if length(varargin) == index || ~ischar(varargin{index})
            break;
        end

        len1 = min(length('visible'),length(varargin{index}));
        if ~strncmpi(varargin{index},'visible',len1)
            try set(gui_hFigure, varargin{index}, varargin{index+1}), catch break, end
        end
    end

    % If handle visibility is set to 'callback', turn it on until finished
    % with OpeningFcn
    gui_HandleVisibility = get(gui_hFigure,'HandleVisibility');
    if strcmp(gui_HandleVisibility, 'callback')
        set(gui_hFigure,'HandleVisibility', 'on');
    end

    feval(gui_State.gui_OpeningFcn, gui_hFigure, [], guidata(gui_hFigure), varargin{:});

    if isscalar(gui_hFigure) && ishghandle(gui_hFigure)
        % Handle the default callbacks of predefined toolbar tools in this
        % GUI, if any
        guidemfile('restoreToolbarToolPredefinedCallback',gui_hFigure); 
        
        % Update handle visibility
        set(gui_hFigure,'HandleVisibility', gui_HandleVisibility);

        % Call openfig again to pick up the saved visibility or apply the
        % one passed in from the P/V pairs
        if ~gui_Exported
            gui_hFigure = local_openfig(gui_State.gui_Name, 'reuse',gui_Visible);
        elseif ~isempty(gui_VisibleInput)
            set(gui_hFigure,'Visible',gui_VisibleInput);
        end
        if strcmpi(get(gui_hFigure, 'Visible'), 'on')
            figure(gui_hFigure);
            
            if gui_Options.singleton
                setappdata(gui_hFigure,'GUIOnScreen', 1);
            end
        end

        % Done with GUI initialization
        if isappdata(gui_hFigure,'InGUIInitialization')
            rmappdata(gui_hFigure,'InGUIInitialization');
        end

        % If handle visibility is set to 'callback', turn it on until
        % finished with OutputFcn
        gui_HandleVisibility = get(gui_hFigure,'HandleVisibility');
        if strcmp(gui_HandleVisibility, 'callback')
            set(gui_hFigure,'HandleVisibility', 'on');
        end
        gui_Handles = guidata(gui_hFigure);
    else
        gui_Handles = [];
    end

    if nargout
        [varargout{1:nargout}] = feval(gui_State.gui_OutputFcn, gui_hFigure, [], gui_Handles);
    else
        feval(gui_State.gui_OutputFcn, gui_hFigure, [], gui_Handles);
    end

    if isscalar(gui_hFigure) && ishghandle(gui_hFigure)
        set(gui_hFigure,'HandleVisibility', gui_HandleVisibility);
    end
end

function gui_hFigure = local_openfig(name, singleton, visible)

% openfig with three arguments was new from R13. Try to call that first, if
% failed, try the old openfig.
if nargin('openfig') == 2
    % OPENFIG did not accept 3rd input argument until R13,
    % toggle default figure visible to prevent the figure
    % from showing up too soon.
    gui_OldDefaultVisible = get(0,'defaultFigureVisible');
    set(0,'defaultFigureVisible','off');
    gui_hFigure = matlab.hg.internal.openfigLegacy(name, singleton);
    set(0,'defaultFigureVisible',gui_OldDefaultVisible);
else
    % Call version of openfig that accepts 'auto' option"
    gui_hFigure = matlab.hg.internal.openfigLegacy(name, singleton, visible);  
%     %workaround for CreateFcn not called to create ActiveX
%         peers=findobj(findall(allchild(gui_hFigure)),'type','uicontrol','style','text');    
%         for i=1:length(peers)
%             if isappdata(peers(i),'Control')
%                 actxproxy(peers(i));
%             end            
%         end
end

function result = local_isInvokeActiveXCallback(gui_State, varargin)

try
    result = ispc && iscom(varargin{1}) ...
             && isequal(varargin{1},gcbo);
catch
    result = false;
end

function result = local_isInvokeHGCallback(gui_State, varargin)

try
    fhandle = functions(gui_State.gui_Callback);
    result = ~isempty(findstr(gui_State.gui_Name,fhandle.file)) || ...
             (ischar(varargin{1}) ...
             && isequal(ishghandle(varargin{2}), 1) ...
             && (~isempty(strfind(varargin{1},[get(varargin{2}, 'Tag'), '_'])) || ...
                ~isempty(strfind(varargin{1}, '_CreateFcn'))) );
catch
    result = false;
end


